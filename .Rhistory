response.plot(y, Burn.intensity.soil)
response.plot(y, Burn.intensity.Canopy)
response.plot(y, Existing.vegetation)
library(DiversityOccupancy)
response.plot(y, Existing.vegetation)
response.plot(y, Burn.intensity.Canopy)
response.plot(y, Burn.intensity.soil)
response.plot(y, Existing.vegetation)
response.plot(y, Burn.intensity.soil)
response.plot(y, Existing.vegetation)
response.plot(y, Burn.intensity.soil)
y$Best_model
library(DiversityOccupancy)
library(DiversityOccupancy)
response.plot(y, Burn.intensity.soil)
response.plot(y, Existing.vegetation)
response.plot(y, Burn.intensity.soil)
response.plot(y, Burn.intensity.Canopy)
z
z<-response.plot(y, Burn.intensity.Canopy)
z
data("BatOccu")
data("Dailycov")
data("sampling.cov")
View(BatOccu)
View(sampling.cov)
View(Dailycov)
x <-diversityoccu(pres = BatOccu, sitecov = sampling.cov, obscov = Dailycov,
spp = 17, form = ~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~
Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy +
I(Burn.intensity.Canopy^2) + Burn.intensity.basal +
I(Burn.intensity.basal^2))
x
names(x)
x$Covs
x$models
x$Diversity
x$Covs
names(x$Covs)
y <- model.diversity(x, method = "g")
y
names(y)
y$Best_model
y$Table
y$coeff
y$dataset
y$Best_model
response.plot(y, Burn.intensity.Canopy)
response.plot(y, Existing.vegetation)
response.plot(y, Burn.intensity.soil)
response.plot(y, Burn.intensity.basal)
response.plot(y, Burn.intensity.soil)
response.plot(y, Burn.intensity.basal)
response.plot(y, Existing.vegetation)
response.plot(y, Burn.intensity.soil)
library(DiversityOccupancy)
?response.plot
data("BatOccu")
data("Dailycov")
data("sampling.cov")
x <-diversityoccu(pres = BatOccu, sitecov = sampling.cov, obscov = Dailycov,
spp = 17, form = ~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~
Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy +
I(Burn.intensity.Canopy^2) + Burn.intensity.basal +
I(Burn.intensity.basal^2))
y <- model.diversity(x, method = "g")
model.diversity2 <- function(DivOcc, method = "h", confsetsize = 5){
A <- cbind(DivOcc$Diversity, DivOcc$Covs)
colnames(A)[1]<-"Diversity"
B <- paste(names(DivOcc$Covs), "+")
B <- toString(B)
B <- gsub(",", " ", B)
B <- paste("Diversity ~", B, collapse = " ")
B <- as.formula(substr(B, 1, nchar(B)-1))
return (B)
}
model.diversity2(y)
model.diversity2(x)
model.diversity2 <- function(DivOcc, method = "h", confsetsize = 5){
A <- cbind(DivOcc$Diversity, DivOcc$Covs)
colnames(A)[1]<-"Diversity"
B <- paste(names(DivOcc$Covs), "+")
B <- toString(B)
B <- gsub(",", " ", B)
C <- paste("I("names(DivOcc$Covs), "^2) +")
C <- toString(C)
C <- gsub(",", " ", C)
B <- paste("Diversity ~", B, C, collapse = " ")
B <- as.formula(substr(B, 1, nchar(B)-1))
return (B)
}
model.diversity2 <- function(DivOcc, method = "h", confsetsize = 5){
A <- cbind(DivOcc$Diversity, DivOcc$Covs)
colnames(A)[1]<-"Diversity"
B <- paste(names(DivOcc$Covs), "+")
B <- toString(B)
B <- gsub(",", " ", B)
C <- paste("I("names(DivOcc$Covs), "^2) +")
C <- toString(C)
C <- gsub(",", " ", C)
B <- paste("Diversity ~", B, C, collapse = " ")
B <- as.formula(substr(B, 1, nchar(B)-1))
return (B)
}
model.diversity2 <- function(DivOcc, method = "h", confsetsize = 5){
A <- cbind(DivOcc$Diversity, DivOcc$Covs)
colnames(A)[1]<-"Diversity"
B <- paste(names(DivOcc$Covs), "+")
B <- toString(B)
B <- gsub(",", " ", B)
C <- paste("I("names(DivOcc$Covs), "^2) +")
C <- toString(C)
C <- gsub(",", " ", C)
B <- paste("Diversity ~", B, C, collapse = " ")
B <- as.formula(substr(B, 1, nchar(B)-1))
return (B)
}
B <- gsub(",", " ", B)
model.diversity2 <- function(DivOcc, method = "h", confsetsize = 5){
A <- cbind(DivOcc$Diversity, DivOcc$Covs)
colnames(A)[1]<-"Diversity"
B <- paste(names(DivOcc$Covs), "+")
B <- toString(B)
B <- gsub(",", " ", B)
B <- paste("Diversity ~", B, collapse = " ")
B <- as.formula(substr(B, 1, nchar(B)-1))
return (B)
}
model.diversity2 <- function(DivOcc, method = "h", confsetsize = 5){
A <- cbind(DivOcc$Diversity, DivOcc$Covs)
colnames(A)[1]<-"Diversity"
B <- paste(names(DivOcc$Covs), "+")
B <- toString(B)
B <- gsub(",", " ", B)
C <- paste(names(DivOcc$Covs), "+")
B <- paste("Diversity ~", B, collapse = " ")
B <- as.formula(substr(B, 1, nchar(B)-1))
return (B)
}
model.diversity2 <- function(DivOcc, method = "h", confsetsize = 5){
A <- cbind(DivOcc$Diversity, DivOcc$Covs)
colnames(A)[1]<-"Diversity"
B <- paste(names(DivOcc$Covs), "+")
B <- toString(B)
B <- gsub(",", " ", B)
C <- paste("I(", names(DivOcc$Covs), "+")
B <- paste("Diversity ~", B, collapse = " ")
B <- as.formula(substr(B, 1, nchar(B)-1))
return (B)
}
model.diversity2 <- function(DivOcc, method = "h", confsetsize = 5){
A <- cbind(DivOcc$Diversity, DivOcc$Covs)
colnames(A)[1]<-"Diversity"
B <- paste(names(DivOcc$Covs), "+")
B <- toString(B)
B <- gsub(",", " ", B)
C <- paste("I(", names(DivOcc$Covs), "^2) +")
B <- paste("Diversity ~", B, collapse = " ")
B <- as.formula(substr(B, 1, nchar(B)-1))
return (B)
}
model.diversity2 <- function(DivOcc, method = "h", confsetsize = 5){
A <- cbind(DivOcc$Diversity, DivOcc$Covs)
colnames(A)[1]<-"Diversity"
B <- paste(names(DivOcc$Covs), "+")
B <- toString(B)
B <- gsub(",", " ", B)
C <- paste("I(", names(DivOcc$Covs), "^2) +")
C<- toString(C)
B <- paste("Diversity ~", B, collapse = " ")
B <- as.formula(substr(B, 1, nchar(B)-1))
return (B)
}
model.diversity2(x)
model.diversity2 <- function(DivOcc, method = "h", confsetsize = 5){
A <- cbind(DivOcc$Diversity, DivOcc$Covs)
colnames(A)[1]<-"Diversity"
B <- paste(names(DivOcc$Covs), "+")
B <- toString(B)
B <- gsub(",", " ", B)
C <- paste("I(", names(DivOcc$Covs), "^2) +")
C <- toString(C)
C <- gsub (",", " ", C)
B <- paste("Diversity ~", B, collapse = " ")
B <- as.formula(substr(B, 1, nchar(B)-1))
return (B)
}
model.diversity2 <- function(DivOcc, method = "h", confsetsize = 5){
A <- cbind(DivOcc$Diversity, DivOcc$Covs)
colnames(A)[1]<-"Diversity"
B <- paste(names(DivOcc$Covs), "+")
B <- toString(B)
B <- gsub(",", " ", B)
C <- paste("I(", names(DivOcc$Covs), "^2) +")
C <- toString(C)
C <- gsub (",", " ", C)
B <- paste("Diversity ~", B, C, collapse = " ")
B <- as.formula(substr(B, 1, nchar(B)-1))
return (B)
}
model.diversity2(x)
library(DiversityOccupancy)
model.diversity2(x)
model.diversity(x)
library(DiversityOccupancy)
model.diversity(x)
model.diversity2 <- function(DivOcc, method = "h", confsetsize = 5){
A <- cbind(DivOcc$Diversity, DivOcc$Covs)
colnames(A)[1]<-"Diversity"
B <- paste(names(DivOcc$Covs), "+")
B <- toString(B)
B <- gsub(",", " ", B)
C <- paste("I(", names(DivOcc$Covs), "^2) +")
C <- toString(C)
C <- gsub (",", " ", C)
B <- paste("Diversity ~", B, C, collapse = " ")
B <- as.formula(substr(B, 1, nchar(B)-1))
B <- glm(B, data = A)
D <- glmulti(B, level = 1, crit = "aicc", confsetsize = confsetsize, plotty = FALSE, method = method)
Best.model <- D@formulas[[1]]
Table <- weightable(D)
Table$Delta.AICc <- Table[,2]-Table[1,2]
d<-summary(glm(Best.model, data = A))
result <- list(Best_model = Best.model, Table = Table, coeff = d, dataset= A)
return(result)
}
y <- model.diversity(x, method = "g")
model.diversity2 <- function(DivOcc, method = "h", confsetsize = 5){
A <- cbind(DivOcc$Diversity, DivOcc$Covs)
colnames(A)[1]<-"Diversity"
B <- paste(names(DivOcc$Covs), "+")
B <- toString(B)
B <- gsub(",", " ", B)
C <- paste("I(", names(DivOcc$Covs), "^2) +")
C <- toString(C)
C <- gsub (",", " ", C)
B <- paste("Diversity ~", B, C, collapse = " ")
B <- as.formula(substr(B, 1, nchar(B)-1))
B <- glm(B, data = A)
D <- glmulti(B, level = 1, crit = "aicc", confsetsize = confsetsize, plotty = FALSE, method = method)
Best.model <- D@formulas[[1]]
Table <- weightable(D)
Table$Delta.AICc <- Table[,2]-Table[1,2]
d<-summary(glm(Best.model, data = A))
result <- list(Best_model = Best.model, Table = Table, coeff = d, dataset= A)
return(result)
}
y <- model.diversity2(x, method = "g")
library("glmulti", lib.loc="~/R/x86_64-pc-linux-gnu-library/3.2")
y <- model.diversity2(x, method = "g")
model.diversity2 <- function(DivOcc, method = "h", confsetsize = 5){
A <- cbind(DivOcc$Diversity, DivOcc$Covs)
colnames(A)[1]<-"Diversity"
B <- paste(names(DivOcc$Covs), "+")
B <- toString(B)
B <- gsub(",", " ", B)
C <- paste("I(", names(DivOcc$Covs), "^2) +")
C <- toString(C)
C <- gsub (",", " ", C)
B <- paste("Diversity ~", B, C, collapse = " ")
B <- as.formula(substr(B, 1, nchar(B)-1))
B <- glm(B, data = A)
return(B)
}
y <- model.diversity2(x, method = "g")
y
glmulti(y, method="d")
data("BatOccu")
data("Dailycov")
data("sampling.cov")
x <-diversityoccu(pres = BatOccu, sitecov = sampling.cov[,1:8], obscov = Dailycov,
spp = 17, form = ~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~
Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy +
I(Burn.intensity.Canopy^2) + Burn.intensity.basal +
I(Burn.intensity.basal^2))
y <- model.diversity2(x, method = "g")
y
model.diversity2 <- function(DivOcc, method = "h", confsetsize = 5){
A <- cbind(DivOcc$Diversity, DivOcc$Covs)
colnames(A)[1]<-"Diversity"
B <- paste(names(DivOcc$Covs), "+")
B <- toString(B)
B <- gsub(",", " ", B)
C <- paste("I(", names(DivOcc$Covs), "^2) +")
C <- toString(C)
C <- gsub (",", " ", C)
B <- paste("Diversity ~", B, C, collapse = " ")
B <- as.formula(substr(B, 1, nchar(B)-1))
B <- glm(B, data = A)
D <- glmulti(B, level = 1, crit = "aicc", confsetsize = confsetsize, plotty = FALSE, method = method)
Best.model <- D@formulas[[1]]
Table <- weightable(D)
Table$Delta.AICc <- Table[,2]-Table[1,2]
d<-summary(glm(Best.model, data = A))
result <- list(Best_model = Best.model, Table = Table, coeff = d, dataset= A)
return(result)
}
y <- model.diversity2(x, method = "g")
x
y <- model.diversity2(x, method = "g")
y <- model.diversity2(x, method = "g")
y
y$Table
response.plot(y, Burn.intensity.soil)
response.plot(y, Burn.intensity.Canopy)
response.plot(y, Existing.vegetation)
response.plot(y, Burn.intensity.soil)
model.diversity2 <- function(DivOcc, method = "h", confsetsize = 5, squared = FALSE){
A <- cbind(DivOcc$Diversity, DivOcc$Covs)
colnames(A)[1]<-"Diversity"
B <- paste(names(DivOcc$Covs), "+")
B <- toString(B)
B <- gsub(",", " ", B)
if (squared == TRUE) {
C <- paste("I(", names(DivOcc$Covs), "^2) +")
C <- toString(C)
C <- gsub (",", " ", C)
B <- paste("Diversity ~", B, C, collapse = " ")
}
else if (squared == FALSE) {
B <- paste("Diversity ~", B, C, collapse = " ")
}
B <- as.formula(substr(B, 1, nchar(B)-1))
B <- glm(B, data = A)
D <- glmulti(B, level = 1, crit = "aicc", confsetsize = confsetsize, plotty = FALSE, method = method)
Best.model <- D@formulas[[1]]
Table <- weightable(D)
Table$Delta.AICc <- Table[,2]-Table[1,2]
d<-summary(glm(Best.model, data = A))
result <- list(Best_model = Best.model, Table = Table, coeff = d, dataset= A)
return(result)
}
y <- model.diversity2(x, method = "g", squared = TRUE)
response.plot(y, Burn.intensity.soil)
response.plot(y, Burn.intensity.Canopy)
library(DiversityOccupancy)
y <- model.diversity2(x, method = "g")
y <- model.diversity2(x, method = "g")
y <- model.diversity(x, method = "g")
y <- model.diversity(x, method = "g", squared = TRUE)
y <- model.diversity(x, method = "g", squared = FALSE)
library(DiversityOccupancy)
y <- model.diversity(x, method = "g", squared = FALSE)
y <- model.diversity(x, method = "g", squared = TRUE)
y <- model.diversity(x, method = "g", squared = TRUE)
library(DiversityOccupancy)
?model.diversity
data("BatOccu")
data("Dailycov")
data("sampling.cov")
x <-diversityoccu(pres = BatOccu, sitecov = sampling.cov[,1:8], obscov = Dailycov,
spp = 17, form = ~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~
Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy +
I(Burn.intensity.Canopy^2) + Burn.intensity.basal +
I(Burn.intensity.basal^2))
y <- model.diversity(x, method = "g", squared = TRUE)
y$Table
y
y$Table
detach("package:glmulti", unload=TRUE)
y <- model.diversity(x, method = "g", squared = TRUE)
y$Table
y$Best_model
response.plot(y, Burn.intensity.soil)
response.plot(y, Burn.intensity.Canopy)
response.plot(y, Existing.vegetation)
y <- model.diversity(x, method = "g", squared = TRUE, confsetsize = 10)
y$Table
y <- model.diversity(x, method = "g", squared = TRUE, confsetsize = 10)
y$Table
y$Best_model
z<- response.plot(y, Burn.intensity.Canopy)
z
library(DiversityOccupancy)
library(DiversityOccupancy)
?response.plot
data("BatOccu")
data("Dailycov")
data("sampling.cov")
x <-diversityoccu(pres = BatOccu, sitecov = sampling.cov, obscov = Dailycov,
spp = 17, form = ~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~
Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy +
I(Burn.intensity.Canopy^2) + Burn.intensity.basal +
I(Burn.intensity.basal^2))
y <- model.diversity(x, method = "g")
response.plot(y, Burn.intensity.soil)
response.plot(y, Existing.vegetation)
library(DiversityOccupancy)
response.plot(y, Burn.intensity.soil)
response.plot(y, Existing.vegetation)
library(DiversityOccupancy)
?diversityoccu
data("BatOccu")
data("Dailycov")
data("sampling.cov")
diversityoccu(pres = BatOccu, sitecov = sampling.cov, obscov = Dailycov,
spp = 17, form = ~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~
Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy +
I(Burn.intensity.Canopy^2) + Burn.intensity.basal +
I(Burn.intensity.basal^2))
data("BatOccu")
data("Dailycov")
data("sampling.cov")
n<-diversityoccu(pres = BatOccu[,1:12], sitecov = sampling.cov, obscov = Dailycov,
spp = 4, form = ~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~
Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy +
I(Burn.intensity.Canopy^2) + Burn.intensity.basal +
I(Burn.intensity.basal^2), dredge = TRUE)
library(DiversityOccupancy)
data("BatOccu")
data("Dailycov")
data("sampling.cov")
n<-diversityoccu(pres = BatOccu[,1:12], sitecov = sampling.cov, obscov = Dailycov,
spp = 4, form = ~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~
Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy +
I(Burn.intensity.Canopy^2) + Burn.intensity.basal +
I(Burn.intensity.basal^2), dredge = TRUE)
data("BatOccu")
data("Dailycov")
data("sampling.cov")
n<-diversityoccu(pres = BatOccu[,1:12], sitecov = sampling.cov, obscov = Dailycov,
spp = 4, form = ~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~
Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy +
I(Burn.intensity.Canopy^2) + Burn.intensity.basal +
I(Burn.intensity.basal^2), dredge = TRUE)
x$models
data("BatOccu")
data("Dailycov")
data("sampling.cov")
n<-diversityoccu(pres = BatOccu[,1:12], sitecov = sampling.cov, obscov = Dailycov,
spp = 4, form = ~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~
Burn.intensity.soil + Burn.intensity.Canopy + Burn.intensity.basal , dredge = FALSE)
n
n$models
n$models[[1]]
n$models[[4]]
n$models[[5]]
data("BatOccu")
data("Dailycov")
data("sampling.cov")
n<-diversityoccu(pres = BatOccu[,1:12], sitecov = sampling.cov, obscov = Dailycov,
spp = 4, form = ~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~
Burn.intensity.soil + Burn.intensity.Canopy + Burn.intensity.basal , dredge = TRUE)
n
n$models[[1]]
library(DiversityOccupancy)
data("BatOccu")
data("Dailycov")
data("sampling.cov")
n<-diversityoccu(pres = BatOccu[,1:12], sitecov = sampling.cov, obscov = Dailycov,
spp = 4, form = ~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~
Burn.intensity.soil + Burn.intensity.Canopy + Burn.intensity.basal , dredge = FALSE)
n
library(DiversityOccupancy)
n
data("BatOccu")
data("Dailycov")
data("sampling.cov")
n<-diversityoccu(pres = BatOccu[,1:12], sitecov = sampling.cov, obscov = Dailycov,
spp = 4, form = ~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~
Burn.intensity.soil + Burn.intensity.Canopy + Burn.intensity.basal , dredge = FALSE)
n
data("BatOccu")
data("Dailycov")
data("sampling.cov")
n<-diversityoccu(pres = BatOccu[,1:12], sitecov = sampling.cov, obscov = Dailycov,
spp = 4, form = ~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~
Burn.intensity.soil + Burn.intensity.Canopy + Burn.intensity.basal , dredge = TRUE)
n$models
length(n$models)
library(DiversityOccupancy)
n<-diversityoccu(pres = BatOccu[,1:12], sitecov = sampling.cov, obscov = Dailycov,
spp = 4, form = ~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~
Burn.intensity.soil + Burn.intensity.Canopy + Burn.intensity.basal , dredge = TRUE)
diversityoccu2<- function(pres, sitecov, obscov, spp, form, index = "shannon", dredge = FALSE) {
secuencia <- c(1:spp)*(ncol(pres)/spp)
secuencia2<-secuencia-(secuencia[1]-1)
models <- list()
div <- list()
dredged <- list ()
if (dredge == FALSE){
for(i in 1:length(secuencia)) {
models[[i]] <-c(secuencia2[i]:secuencia[i])
models[[i]] <- pres[, models[[i]]]
models[[i]] <- unmarkedFrameOccu(y = models[[i]], siteCovs = sitecov, obsCovs = obscov)
models[[i]] <- occuRN(form, models[[i]])
div[[i]] <- predict(models[[i]], type = "state", newdata = sitecov)$Predicted
div<- as.data.frame(div)
h<- diversity(div, index)
}
}
else if (dredge == TRUE){
for(i in 1:length(secuencia)) {
models[[i]] <-c(secuencia2[i]:secuencia[i])
models[[i]] <- pres[, models[[i]]]
models[[i]] <- unmarkedFrameOccu(y = models[[i]], siteCovs = sitecov, obsCovs = obscov)
models[[i]] <- occuRN(form, models[[i]])
}
}
result <- list(Covs = sitecov, models = models)
return(result)
}
n<-diversityoccu2(pres = BatOccu[,1:12], sitecov = sampling.cov, obscov = Dailycov,
spp = 4, form = ~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~
Burn.intensity.soil + Burn.intensity.Canopy + Burn.intensity.basal , dredge = TRUE)
library("MuMIn", lib.loc="~/R/x86_64-pc-linux-gnu-library/3.2")
library("unmarked", lib.loc="~/R/x86_64-pc-linux-gnu-library/3.2")
n<-diversityoccu2(pres = BatOccu[,1:12], sitecov = sampling.cov, obscov = Dailycov, spp = 4, form = ~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~Burn.intensity.soil + Burn.intensity.Canopy + Burn.intensity.basal , dredge = TRUE)
n
n$models
devtools::use_vignette("my-vignette")
library(DiversityOccupancy)
