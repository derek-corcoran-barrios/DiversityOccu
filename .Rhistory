b<-predict(glm(model$Best_model, data= model$dataset), newdata = a, se.fit = TRUE)
c<- data.frame(preditction = b$fit, upper = (b$fit + b$se), lower = (b$fit - b$se))
result <-list(c)
return(result)
}
z<-responce.plot(y, Burn.intensity.soil)
z
responce.plot<- function(model, variable){
a<-data.frame(matrix(rep(colMeans(model$dataset), each=length(model$dataset[,1])), nrow = length(model$dataset[,1]), ncol = ncol(model$dataset)))
colnames(a)<-colnames(model$dataset)
maxval<-apply(model$dataset,2,max)
minval<-apply(model$dataset,2,min)
newdata<- seq(from = minval[colnames(a)== as.character(substitute(variable))], to = maxval[colnames(a)== as.character(substitute(variable))], along.with = model$dataset[,1])
a$variable <- newdata
b<-predict(glm(model$Best_model, data= model$dataset), newdata = a, se.fit = TRUE)
c<- data.frame(preditction = b$fit, upper = (b$fit + b$se), lower = (b$fit - b$se), dependent = a$variable)
result <-list(c)
return(result)
}
z
z<-responce.plot(y, Burn.intensity.soil)
z
summary(z)
str(z)
responce.plot<- function(model, variable){
a<-data.frame(matrix(rep(colMeans(model$dataset), each=length(model$dataset[,1])), nrow = length(model$dataset[,1]), ncol = ncol(model$dataset)))
colnames(a)<-colnames(model$dataset)
maxval<-apply(model$dataset,2,max)
minval<-apply(model$dataset,2,min)
newdata<- seq(from = minval[colnames(a)== as.character(substitute(variable))], to = maxval[colnames(a)== as.character(substitute(variable))], along.with = model$dataset[,1])
a$variable <- newdata
b<-predict(glm(model$Best_model, data= model$dataset), newdata = a, se.fit = TRUE)
c<- data.frame(preditction = b$fit, upper = (b$fit + b$se), lower = (b$fit - b$se), dependent = a$variable)
result <-list(c, new = a)
return(result)
}
z<-responce.plot(y, Burn.intensity.soil)
str(z)
z$new
responce.plot<- function(model, variable){
a<-data.frame(matrix(rep(colMeans(model$dataset), each=length(model$dataset[,1])), nrow = length(model$dataset[,1]), ncol = ncol(model$dataset)))
colnames(a)<-colnames(model$dataset)
maxval<-apply(model$dataset,2,max)
minval<-apply(model$dataset,2,min)
newdata<- seq(from = minval[colnames(a)== as.character(substitute(variable))], to = maxval[colnames(a)== as.character(substitute(variable))], along.with = model$dataset[,1])
a[colnames(a)== as.character(substitute(variable))] <- newdata
b<-predict(glm(model$Best_model, data= model$dataset), newdata = a, se.fit = TRUE)
c<- data.frame(preditction = b$fit, upper = (b$fit + b$se), lower = (b$fit - b$se), dependent = a$variable)
result <-list(c, new = a)
return(result)
}
z<-responce.plot(y, Burn.intensity.soil)
responce.plot<- function(model, variable){
a<-data.frame(matrix(rep(colMeans(model$dataset), each=length(model$dataset[,1])), nrow = length(model$dataset[,1]), ncol = ncol(model$dataset)))
colnames(a)<-colnames(model$dataset)
maxval<-apply(model$dataset,2,max)
minval<-apply(model$dataset,2,min)
newdata<- seq(from = minval[colnames(a)== as.character(substitute(variable))], to = maxval[colnames(a)== as.character(substitute(variable))], along.with = model$dataset[,1])
a[colnames(a)== as.character(substitute(variable))] <- newdata
b<-predict(glm(model$Best_model, data= model$dataset), newdata = a, se.fit = TRUE)
c<- data.frame(preditction = b$fit, upper = (b$fit + b$se), lower = (b$fit - b$se), dependent = a[colnames(a)== as.character(substitute(variable))])
result <-list(c, new = a)
return(result)
}
z<-responce.plot(y, Burn.intensity.soil)
z
z$``
z
responce.plot<- function(model, variable){
a<-data.frame(matrix(rep(colMeans(model$dataset), each=length(model$dataset[,1])), nrow = length(model$dataset[,1]), ncol = ncol(model$dataset)))
colnames(a)<-colnames(model$dataset)
maxval<-apply(model$dataset,2,max)
minval<-apply(model$dataset,2,min)
newdata<- seq(from = minval[colnames(a)== as.character(substitute(variable))], to = maxval[colnames(a)== as.character(substitute(variable))], along.with = model$dataset[,1])
a[colnames(a)== as.character(substitute(variable))] <- newdata
b<-predict(glm(model$Best_model, data= model$dataset), newdata = a, se.fit = TRUE)
c<- data.frame(preditction = b$fit, upper = (b$fit + b$se), lower = (b$fit - b$se), dependent = a[colnames(a)== as.character(substitute(variable))])
result <-list(c = c, new = a)
return(result)
}
c
z<-responce.plot(y, Burn.intensity.soil)
z
z$c
z$new
z$c
library(DiversityOccupancy)
z<-responce.plot(y, Burn.intensity.soil)
z
z<-responce.plot(y, Burn.intensity.soil)
library(DiversityOccupancy)
data("BatOccu")
data("Dailycov")
data("sampling.cov")
x <-diversityoccu(pres = BatOccu, sitecov = sampling.cov, obscov = Dailycov,
spp = 17, form = ~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~
Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy +
I(Burn.intensity.Canopy^2) + Burn.intensity.basal +
I(Burn.intensity.basal^2))
y <- model.diversity(x, method = "g")
y$Table
z<-responce.plot(y, Burn.intensity.soil)
z<-response.plot(y, Burn.intensity.soil)
?ggplot
?aes
library(DiversityOccupancy)
z<-response.plot(y, Burn.intensity.soil)
z
response.plot(y, Burn.intensity.soil)
response.plot(y, Burn.intensity.soil)
library(DiversityOccupancy)
response.plot(y, Burn.intensity.soil)
library(DiversityOccupancy)
response.plot(y, Burn.intensity.soil)
library(DiversityOccupancy)
response.plot(y, Burn.intensity.soil)
library(DiversityOccupancy)
response.plot(y, Burn.intensity.soil)
library(DiversityOccupancy)
response.plot(y, Burn.intensity.soil)
y$Best_model
response.plot(y, Burn.intensity.Canopy)
response.plot(y, Existing.vegetation)
z<-response.plot(y, Existing.vegetation)
z
z+theme_bw()
library("ggplot2", lib.loc="~/R/x86_64-pc-linux-gnu-library/3.2")
z+theme_bw()
detach("package:ggplot2", unload=TRUE)
library(DiversityOccupancy)
response.plot(y, Existing.vegetation)
response.plot(y, Burn.intensity.Canopy)
response.plot(y, Burn.intensity.soil)
library(DiversityOccupancy)
response.plot(y, Burn.intensity.soil)
library(DiversityOccupancy)
response.plot(y, Burn.intensity.soil)
library(DiversityOccupancy)
response.plot(y, Burn.intensity.soil)
response.plot(y, Burn.intensity.Canopy)
response.plot(y, Existing.vegetation)
library(DiversityOccupancy)
response.plot(y, Existing.vegetation)
response.plot(y, Burn.intensity.Canopy)
response.plot(y, Burn.intensity.soil)
response.plot(y, Existing.vegetation)
response.plot(y, Burn.intensity.soil)
response.plot(y, Existing.vegetation)
response.plot(y, Burn.intensity.soil)
y$Best_model
library(DiversityOccupancy)
library(DiversityOccupancy)
response.plot(y, Burn.intensity.soil)
response.plot(y, Existing.vegetation)
response.plot(y, Burn.intensity.soil)
response.plot(y, Burn.intensity.Canopy)
z
z<-response.plot(y, Burn.intensity.Canopy)
z
data("BatOccu")
data("Dailycov")
data("sampling.cov")
View(BatOccu)
View(sampling.cov)
View(Dailycov)
x <-diversityoccu(pres = BatOccu, sitecov = sampling.cov, obscov = Dailycov,
spp = 17, form = ~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~
Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy +
I(Burn.intensity.Canopy^2) + Burn.intensity.basal +
I(Burn.intensity.basal^2))
x
names(x)
x$Covs
x$models
x$Diversity
x$Covs
names(x$Covs)
y <- model.diversity(x, method = "g")
y
names(y)
y$Best_model
y$Table
y$coeff
y$dataset
y$Best_model
response.plot(y, Burn.intensity.Canopy)
response.plot(y, Existing.vegetation)
response.plot(y, Burn.intensity.soil)
response.plot(y, Burn.intensity.basal)
response.plot(y, Burn.intensity.soil)
response.plot(y, Burn.intensity.basal)
response.plot(y, Existing.vegetation)
response.plot(y, Burn.intensity.soil)
library(DiversityOccupancy)
?response.plot
data("BatOccu")
data("Dailycov")
data("sampling.cov")
x <-diversityoccu(pres = BatOccu, sitecov = sampling.cov, obscov = Dailycov,
spp = 17, form = ~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~
Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy +
I(Burn.intensity.Canopy^2) + Burn.intensity.basal +
I(Burn.intensity.basal^2))
y <- model.diversity(x, method = "g")
model.diversity2 <- function(DivOcc, method = "h", confsetsize = 5){
A <- cbind(DivOcc$Diversity, DivOcc$Covs)
colnames(A)[1]<-"Diversity"
B <- paste(names(DivOcc$Covs), "+")
B <- toString(B)
B <- gsub(",", " ", B)
B <- paste("Diversity ~", B, collapse = " ")
B <- as.formula(substr(B, 1, nchar(B)-1))
return (B)
}
model.diversity2(y)
model.diversity2(x)
model.diversity2 <- function(DivOcc, method = "h", confsetsize = 5){
A <- cbind(DivOcc$Diversity, DivOcc$Covs)
colnames(A)[1]<-"Diversity"
B <- paste(names(DivOcc$Covs), "+")
B <- toString(B)
B <- gsub(",", " ", B)
C <- paste("I("names(DivOcc$Covs), "^2) +")
C <- toString(C)
C <- gsub(",", " ", C)
B <- paste("Diversity ~", B, C, collapse = " ")
B <- as.formula(substr(B, 1, nchar(B)-1))
return (B)
}
model.diversity2 <- function(DivOcc, method = "h", confsetsize = 5){
A <- cbind(DivOcc$Diversity, DivOcc$Covs)
colnames(A)[1]<-"Diversity"
B <- paste(names(DivOcc$Covs), "+")
B <- toString(B)
B <- gsub(",", " ", B)
C <- paste("I("names(DivOcc$Covs), "^2) +")
C <- toString(C)
C <- gsub(",", " ", C)
B <- paste("Diversity ~", B, C, collapse = " ")
B <- as.formula(substr(B, 1, nchar(B)-1))
return (B)
}
model.diversity2 <- function(DivOcc, method = "h", confsetsize = 5){
A <- cbind(DivOcc$Diversity, DivOcc$Covs)
colnames(A)[1]<-"Diversity"
B <- paste(names(DivOcc$Covs), "+")
B <- toString(B)
B <- gsub(",", " ", B)
C <- paste("I("names(DivOcc$Covs), "^2) +")
C <- toString(C)
C <- gsub(",", " ", C)
B <- paste("Diversity ~", B, C, collapse = " ")
B <- as.formula(substr(B, 1, nchar(B)-1))
return (B)
}
B <- gsub(",", " ", B)
model.diversity2 <- function(DivOcc, method = "h", confsetsize = 5){
A <- cbind(DivOcc$Diversity, DivOcc$Covs)
colnames(A)[1]<-"Diversity"
B <- paste(names(DivOcc$Covs), "+")
B <- toString(B)
B <- gsub(",", " ", B)
B <- paste("Diversity ~", B, collapse = " ")
B <- as.formula(substr(B, 1, nchar(B)-1))
return (B)
}
model.diversity2 <- function(DivOcc, method = "h", confsetsize = 5){
A <- cbind(DivOcc$Diversity, DivOcc$Covs)
colnames(A)[1]<-"Diversity"
B <- paste(names(DivOcc$Covs), "+")
B <- toString(B)
B <- gsub(",", " ", B)
C <- paste(names(DivOcc$Covs), "+")
B <- paste("Diversity ~", B, collapse = " ")
B <- as.formula(substr(B, 1, nchar(B)-1))
return (B)
}
model.diversity2 <- function(DivOcc, method = "h", confsetsize = 5){
A <- cbind(DivOcc$Diversity, DivOcc$Covs)
colnames(A)[1]<-"Diversity"
B <- paste(names(DivOcc$Covs), "+")
B <- toString(B)
B <- gsub(",", " ", B)
C <- paste("I(", names(DivOcc$Covs), "+")
B <- paste("Diversity ~", B, collapse = " ")
B <- as.formula(substr(B, 1, nchar(B)-1))
return (B)
}
model.diversity2 <- function(DivOcc, method = "h", confsetsize = 5){
A <- cbind(DivOcc$Diversity, DivOcc$Covs)
colnames(A)[1]<-"Diversity"
B <- paste(names(DivOcc$Covs), "+")
B <- toString(B)
B <- gsub(",", " ", B)
C <- paste("I(", names(DivOcc$Covs), "^2) +")
B <- paste("Diversity ~", B, collapse = " ")
B <- as.formula(substr(B, 1, nchar(B)-1))
return (B)
}
model.diversity2 <- function(DivOcc, method = "h", confsetsize = 5){
A <- cbind(DivOcc$Diversity, DivOcc$Covs)
colnames(A)[1]<-"Diversity"
B <- paste(names(DivOcc$Covs), "+")
B <- toString(B)
B <- gsub(",", " ", B)
C <- paste("I(", names(DivOcc$Covs), "^2) +")
C<- toString(C)
B <- paste("Diversity ~", B, collapse = " ")
B <- as.formula(substr(B, 1, nchar(B)-1))
return (B)
}
model.diversity2(x)
model.diversity2 <- function(DivOcc, method = "h", confsetsize = 5){
A <- cbind(DivOcc$Diversity, DivOcc$Covs)
colnames(A)[1]<-"Diversity"
B <- paste(names(DivOcc$Covs), "+")
B <- toString(B)
B <- gsub(",", " ", B)
C <- paste("I(", names(DivOcc$Covs), "^2) +")
C <- toString(C)
C <- gsub (",", " ", C)
B <- paste("Diversity ~", B, collapse = " ")
B <- as.formula(substr(B, 1, nchar(B)-1))
return (B)
}
model.diversity2 <- function(DivOcc, method = "h", confsetsize = 5){
A <- cbind(DivOcc$Diversity, DivOcc$Covs)
colnames(A)[1]<-"Diversity"
B <- paste(names(DivOcc$Covs), "+")
B <- toString(B)
B <- gsub(",", " ", B)
C <- paste("I(", names(DivOcc$Covs), "^2) +")
C <- toString(C)
C <- gsub (",", " ", C)
B <- paste("Diversity ~", B, C, collapse = " ")
B <- as.formula(substr(B, 1, nchar(B)-1))
return (B)
}
model.diversity2(x)
library(DiversityOccupancy)
model.diversity2(x)
model.diversity(x)
library(DiversityOccupancy)
model.diversity(x)
model.diversity2 <- function(DivOcc, method = "h", confsetsize = 5){
A <- cbind(DivOcc$Diversity, DivOcc$Covs)
colnames(A)[1]<-"Diversity"
B <- paste(names(DivOcc$Covs), "+")
B <- toString(B)
B <- gsub(",", " ", B)
C <- paste("I(", names(DivOcc$Covs), "^2) +")
C <- toString(C)
C <- gsub (",", " ", C)
B <- paste("Diversity ~", B, C, collapse = " ")
B <- as.formula(substr(B, 1, nchar(B)-1))
B <- glm(B, data = A)
D <- glmulti(B, level = 1, crit = "aicc", confsetsize = confsetsize, plotty = FALSE, method = method)
Best.model <- D@formulas[[1]]
Table <- weightable(D)
Table$Delta.AICc <- Table[,2]-Table[1,2]
d<-summary(glm(Best.model, data = A))
result <- list(Best_model = Best.model, Table = Table, coeff = d, dataset= A)
return(result)
}
y <- model.diversity(x, method = "g")
model.diversity2 <- function(DivOcc, method = "h", confsetsize = 5){
A <- cbind(DivOcc$Diversity, DivOcc$Covs)
colnames(A)[1]<-"Diversity"
B <- paste(names(DivOcc$Covs), "+")
B <- toString(B)
B <- gsub(",", " ", B)
C <- paste("I(", names(DivOcc$Covs), "^2) +")
C <- toString(C)
C <- gsub (",", " ", C)
B <- paste("Diversity ~", B, C, collapse = " ")
B <- as.formula(substr(B, 1, nchar(B)-1))
B <- glm(B, data = A)
D <- glmulti(B, level = 1, crit = "aicc", confsetsize = confsetsize, plotty = FALSE, method = method)
Best.model <- D@formulas[[1]]
Table <- weightable(D)
Table$Delta.AICc <- Table[,2]-Table[1,2]
d<-summary(glm(Best.model, data = A))
result <- list(Best_model = Best.model, Table = Table, coeff = d, dataset= A)
return(result)
}
y <- model.diversity2(x, method = "g")
library("glmulti", lib.loc="~/R/x86_64-pc-linux-gnu-library/3.2")
y <- model.diversity2(x, method = "g")
model.diversity2 <- function(DivOcc, method = "h", confsetsize = 5){
A <- cbind(DivOcc$Diversity, DivOcc$Covs)
colnames(A)[1]<-"Diversity"
B <- paste(names(DivOcc$Covs), "+")
B <- toString(B)
B <- gsub(",", " ", B)
C <- paste("I(", names(DivOcc$Covs), "^2) +")
C <- toString(C)
C <- gsub (",", " ", C)
B <- paste("Diversity ~", B, C, collapse = " ")
B <- as.formula(substr(B, 1, nchar(B)-1))
B <- glm(B, data = A)
return(B)
}
y <- model.diversity2(x, method = "g")
y
glmulti(y, method="d")
data("BatOccu")
data("Dailycov")
data("sampling.cov")
x <-diversityoccu(pres = BatOccu, sitecov = sampling.cov[,1:8], obscov = Dailycov,
spp = 17, form = ~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~
Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy +
I(Burn.intensity.Canopy^2) + Burn.intensity.basal +
I(Burn.intensity.basal^2))
y <- model.diversity2(x, method = "g")
y
model.diversity2 <- function(DivOcc, method = "h", confsetsize = 5){
A <- cbind(DivOcc$Diversity, DivOcc$Covs)
colnames(A)[1]<-"Diversity"
B <- paste(names(DivOcc$Covs), "+")
B <- toString(B)
B <- gsub(",", " ", B)
C <- paste("I(", names(DivOcc$Covs), "^2) +")
C <- toString(C)
C <- gsub (",", " ", C)
B <- paste("Diversity ~", B, C, collapse = " ")
B <- as.formula(substr(B, 1, nchar(B)-1))
B <- glm(B, data = A)
D <- glmulti(B, level = 1, crit = "aicc", confsetsize = confsetsize, plotty = FALSE, method = method)
Best.model <- D@formulas[[1]]
Table <- weightable(D)
Table$Delta.AICc <- Table[,2]-Table[1,2]
d<-summary(glm(Best.model, data = A))
result <- list(Best_model = Best.model, Table = Table, coeff = d, dataset= A)
return(result)
}
y <- model.diversity2(x, method = "g")
x
y <- model.diversity2(x, method = "g")
y <- model.diversity2(x, method = "g")
y
y$Table
response.plot(y, Burn.intensity.soil)
response.plot(y, Burn.intensity.Canopy)
response.plot(y, Existing.vegetation)
response.plot(y, Burn.intensity.soil)
model.diversity2 <- function(DivOcc, method = "h", confsetsize = 5, squared = FALSE){
A <- cbind(DivOcc$Diversity, DivOcc$Covs)
colnames(A)[1]<-"Diversity"
B <- paste(names(DivOcc$Covs), "+")
B <- toString(B)
B <- gsub(",", " ", B)
if (squared == TRUE) {
C <- paste("I(", names(DivOcc$Covs), "^2) +")
C <- toString(C)
C <- gsub (",", " ", C)
B <- paste("Diversity ~", B, C, collapse = " ")
}
else if (squared == FALSE) {
B <- paste("Diversity ~", B, C, collapse = " ")
}
B <- as.formula(substr(B, 1, nchar(B)-1))
B <- glm(B, data = A)
D <- glmulti(B, level = 1, crit = "aicc", confsetsize = confsetsize, plotty = FALSE, method = method)
Best.model <- D@formulas[[1]]
Table <- weightable(D)
Table$Delta.AICc <- Table[,2]-Table[1,2]
d<-summary(glm(Best.model, data = A))
result <- list(Best_model = Best.model, Table = Table, coeff = d, dataset= A)
return(result)
}
y <- model.diversity2(x, method = "g", squared = TRUE)
response.plot(y, Burn.intensity.soil)
response.plot(y, Burn.intensity.Canopy)
library(DiversityOccupancy)
y <- model.diversity2(x, method = "g")
y <- model.diversity2(x, method = "g")
y <- model.diversity(x, method = "g")
y <- model.diversity(x, method = "g", squared = TRUE)
y <- model.diversity(x, method = "g", squared = FALSE)
library(DiversityOccupancy)
y <- model.diversity(x, method = "g", squared = FALSE)
y <- model.diversity(x, method = "g", squared = TRUE)
y <- model.diversity(x, method = "g", squared = TRUE)
library(DiversityOccupancy)
?model.diversity
data("BatOccu")
data("Dailycov")
data("sampling.cov")
x <-diversityoccu(pres = BatOccu, sitecov = sampling.cov[,1:8], obscov = Dailycov,
spp = 17, form = ~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~
Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy +
I(Burn.intensity.Canopy^2) + Burn.intensity.basal +
I(Burn.intensity.basal^2))
y <- model.diversity(x, method = "g", squared = TRUE)
y$Table
y
y$Table
detach("package:glmulti", unload=TRUE)
y <- model.diversity(x, method = "g", squared = TRUE)
y$Table
y$Best_model
response.plot(y, Burn.intensity.soil)
response.plot(y, Burn.intensity.Canopy)
response.plot(y, Existing.vegetation)
y <- model.diversity(x, method = "g", squared = TRUE, confsetsize = 10)
y$Table
y <- model.diversity(x, method = "g", squared = TRUE, confsetsize = 10)
y$Table
y$Best_model
z<- response.plot(y, Burn.intensity.Canopy)
z
library(DiversityOccupancy)
