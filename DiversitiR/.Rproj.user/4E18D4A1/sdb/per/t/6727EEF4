{
    "contents" : "---\ntitle: \"Untitled\"\nauthor: \"Derek Corcoran\"\ndate: \"January 5, 2016\"\noutput: html_document\n---\n```{r, message=FALSE, warning=FALSE, echo=FALSE,results='hide'}\n#first load libraries\nlibrary(raster)\nlibrary(maps)\nlibrary(maptools)\nlibrary(rgdal)\nlibrary(dplyr)\nlibrary(knitr)\nlibrary(unmarked)\nlibrary(lubridate)\nlibrary(MuMIn)\nlibrary(ggplot2)\nlibrary(RCurl)\nlibrary(foreign)\nlibrary(caret)\nlibrary(dismo)\nlibrary(vegan)\n```\n\n###Myyu\n\n```{r,echo=FALSE, warning=FALSE,message=FALSE}\nsampling.cov2 <- read.csv(\"~/new_bats/Rnew_bats/Bats_data_products/sampling.cov2.csv\")\nsampling.cov2<- sampling.cov2[,-1]\nsampling.cov2<- data.frame(sampling.cov2)\npreprocov <-preProcess(sampling.cov2[,1:8], method = c(\"center\",\"scale\"))\nsampling.cov2<-predict(preprocov, sampling.cov2[,1:8])\n\nDailycov3 <- read.csv(\"~/new_bats/Rnew_bats/Bats_data_products/Dailycov3.csv\")\nDailycov3 <- Dailycov3 [,-1]\n\n\npreproDaily <-preProcess(Dailycov3[,], method = c(\"knnImpute\"))\nDailycov3<-predict(preproDaily, Dailycov3)\n\nJulian<-Dailycov3[,1:3]\nMax.hum<-Dailycov3[,4:6]\nMax.temp<-Dailycov3[,7:9]\nMean.hum<-Dailycov3[,10:12]\nMean.temp<-Dailycov3[,13:15]\nMin.hum<-Dailycov3[,16:18]\nMin.temp<-Dailycov3[,19:21]\nSd.hum<-Dailycov3[,22:24]\nSd.temp<-Dailycov3[,25:27]\n\nDailycov3<- list(Julian,Max.hum, Max.temp, Mean.hum,Mean.temp, Min.hum, Min.temp, Sd.hum, Sd.temp)\nnames(Dailycov3) <- c(\"Julian\", \"Maxhum\",\"Maxtemp\",\"Meanhum\", \"Meantemp\",\"Minhum\",\"Mintemp\",\"sdhum\",\"sdtemp\")\n```\n\n```{r, echo=FALSE}\n#then add the data\nRESULTS <- read.csv(\"~/new_bats/Rnew_bats/Bats_data_products/RESULTS.csv\")\nRESULTS <- RESULTS[,-1]\nRESULTS$START.DATE<- dmy(as.character(RESULTS$START.DATE), tz = \"America/Los_Angeles\")\nRESULTS$END.DATE<- dmy(as.character(RESULTS$END.DATE), tz = \"America/Los_Angeles\")\n```\n\n```{r,echo=FALSE, warning=FALSE,message=FALSE}\nBatOccu <- read.csv(\"~/new_bats/Rnew_bats/BatOccu.csv\")\n#print(BatOccu)\n```\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE}\n#N=49a\nBatOccuMyYu<-BatOccu[,2:4]\n\nSimOccuMyYu2<-unmarkedFrameOccu(y = BatOccuMyYu, siteCovs =sampling.cov2, obsCovs=Dailycov3)\n\nmodel.Occu1.My.Yu2 <- occuRN(~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~  Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy + I(Burn.intensity.Canopy^2) + Burn.intensity.basal + I(Burn.intensity.basal^2),SimOccuMyYu2)\n\n#select.My.Yu2 <- dredge(model.Occu1.My.Yu2, rank = \"AICc\")\n\n#best2.My.Yu2<-get.models(select.My.Yu2, 1)[[1]]\n\ndivmyyu<-predict(model.Occu1.My.Yu2 , type = \"state\", newdata=sampling.cov2)$Predicted\n```\n\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE, results='hide'}\n#N=49\nBatOccuMyCa<-BatOccu[,5:7]\n```\n\n###Myca\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE}\n#N=49\n\nSimOccuMyCa2<-unmarkedFrameOccu(y = BatOccuMyCa, siteCovs =sampling.cov2, obsCovs=Dailycov3)\n\nmodel.Occu1.My.Ca2 <- occuRN(~ Julian +  Meanhum + Meantemp + sdhum + sdtemp ~ Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy + I(Burn.intensity.Canopy^2) + Burn.intensity.basal + I(Burn.intensity.basal^2), SimOccuMyCa2)\n\n#select.My.Ca2 <- dredge(model.Occu1.My.Ca2, rank = \"AICc\")\n\n#best2.My.Ca2<-get.models(select.My.Ca2, 1)[[1]]\n#Occu1.layer.MyCa2 <- predict(best2.My.Ca2, type = \"state\", newdata=Predictors)\n\n#Occu1.layer.MyCa2<-Occu1.layer.MyCa2*PNF\n#plot(Occu1.layer.MyCa2$layer.1, colNA=\"black\", main=\"Occupancy estimation for California Bat\",breaks=brks, col=cols,lab.breaks=brks, zlim=c(0,1))\n\nmodel.Occu1.My.Ca2 \n\ndivmyca<-predict(model.Occu1.My.Ca2 , type = \"state\", newdata=sampling.cov2)$Predicted\n```\n\n\n###MYCY\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE, results='hide'}\n#N=49\nBatOccuMyCi<-BatOccu[,8:10]\n\n```\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE}\n#N=49\nSimOccuMyCi2<-unmarkedFrameOccu(y = BatOccuMyCi, siteCovs =sampling.cov2, obsCovs=Dailycov3)\n\nmodel.Occu1.My.Ci2 <- occuRN(~ Julian+ Meanhum + Meantemp + sdhum + sdtemp ~ Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy + I(Burn.intensity.Canopy^2) + Burn.intensity.basal + I(Burn.intensity.basal^2), SimOccuMyCi2)\ndivmyci<-predict(model.Occu1.My.Ci2 , type = \"state\", newdata=sampling.cov2)$Predicted\n```\n\n###Myvo\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE, results='hide'}\n#N=49\n\nBatOccuMyVo<-BatOccu[,11:13]\n```\n\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE}\n#N=49\nSimOccuMyVo2<-unmarkedFrameOccu(y = BatOccuMyVo, siteCovs =sampling.cov2, obsCovs=Dailycov3)\n\nmodel.Occu1.My.Vo2 <- occuRN(~ Julian + Meanhum + Meantemp ~  Burn.intensity.soil  + Burn.intensity.Canopy + Burn.intensity.basal,SimOccuMyVo2)\ndivmyvo<-predict(model.Occu1.My.Vo2 , type = \"state\", newdata=sampling.cov2)$Predicted\n```\n\n###Myvo\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE, results='hide'}\n#N=49\nBatOccuMyLu<-BatOccu[,14:16]\n\n```\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE}\nSimOccuMyLu2<-unmarkedFrameOccu(y = BatOccuMyLu, siteCovs =sampling.cov2, obsCovs=Dailycov3)\n\nmodel.Occu1.My.Lu2 <- occuRN(~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~ Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy + I(Burn.intensity.Canopy^2) + Burn.intensity.basal +I(Burn.intensity.basal^2), SimOccuMyLu2)\ndivmylu<-predict(model.Occu1.My.Lu2 , type = \"state\", newdata=sampling.cov2)$Predicted\n```\n\n##Western Red Bat (*Lasiurus blossevillii*)\n\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE, results='hide'}\n#N=49\nBatOccuLaBl<-BatOccu[,20:22]\n```\n\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE}\n#N=49\n\nSimOccuLaBl2<-unmarkedFrameOccu(y = BatOccuLaBl, siteCovs =sampling.cov2, obsCovs=Dailycov3)\n\nmodel.Occu1.La.Bl2 <- occuRN(~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~ Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy + I(Burn.intensity.Canopy^2) + Burn.intensity.basal + I(Burn.intensity.basal^2) ,SimOccuLaBl2)\ndivlabl<-predict(model.Occu1.La.Bl2 , type = \"state\", newdata=sampling.cov2)$Predicted\n```\n\n#Diversity\n\n\n```{r, echo=TRUE}\nclass(divmyca)\ndiv<-cbind(divmyca, divmyyu, divmyci, divmyvo, divmylu, divlabl)\nclass(div)\nkable(div)\nh<-diversity(div)\nkable(BatOccu)\nplot(h)\n\nspecnumber(div)\n```\n\n\n#Paquete\n\n```{r, echo=TRUE}\nBatOccu<-BatOccu[,-1]\nkable(BatOccu)\n\ndiversityoccu<- function(pres, sitecov, obscov, spp, form) {\n  \n  secuencia <- c(1:spp)*(ncol(pres)/spp)\n  secuencia2<-secuencia-(secuencia[1]-1)\n  \n  models <- list()\n  div <- list()\n  \n  for(i in 1:length(secuencia))\n  {\n    models[[i]] <-c(secuencia2[i]:secuencia[i])\n    models[[i]] <- pres[,models[[i]]]\n    models[[i]] <- unmarkedFrameOccu(y = models[[i]], siteCovs =sitecov, obsCovs=obscov)\n    models[[i]] <- occuRN(form, models[[i]])\n    div[[i]] <- predict(models[[i]], type = \"state\", newdata=sitecov)$Predicted\n    div<- as.data.frame(div)\n    h<- diversity(div)\n  }\n  \n  result <- list(models=models,Diversity=h)\n  return(result)\n}\n\n```\n\n\n```{r, echo=TRUE, cache=TRUE}\na<-diversityoccu(pres = BatOccu, sitecov = sampling.cov2, obscov = Dailycov3, form = ~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~  Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy + I(Burn.intensity.Canopy^2) + Burn.intensity.basal + I(Burn.intensity.basal^2), spp = 17)$Diversity\n\nplot(a)\nhist(a)\n```",
    "created" : 1452019570861.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3437994212",
    "id" : "6727EEF4",
    "lastKnownWriteTime" : 1452116156,
    "path" : "~/DiversitiR/BaseForPack.Rmd",
    "project_path" : "BaseForPack.Rmd",
    "properties" : {
        "tempName" : "Untitled2"
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "type" : "r_markdown"
}