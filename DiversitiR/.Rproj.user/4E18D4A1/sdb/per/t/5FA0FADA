{
    "contents" : "---\ntitle: \"Fire_summary\"\nauthor: \"Derek Corcoran\"\ndate: \"November 9, 2015\"\noutput: html_document\n---\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(cache=FALSE)\n```\n\n#Abstract\n\nThis webpage will show the results of a bat survey study done in the Plumas National Forest in North California. The objective of this study is to determine the distribution of the different species of bats within the park. In order to do that we have performed occupancy models for the species present in the park. The results of this models will be shown as maps showing the probability of occurence of bats in each point, that is, if you see a value of 1, there is a 100% chance of finding a bat in that point, if there is a value of 0 there is 0% chance of finding that specie in that point, if there is a value of 0.5 there is a 50% chance of finding that specie in that point.\n\nAnother result\n\n```{r, message=FALSE, warning=FALSE, echo=FALSE,results='hide'}\n#first load libraries\nlibrary(raster)\nlibrary(rasterVis)\nlibrary(maps)\nlibrary(maptools)\nlibrary(rgdal)\nlibrary(latticeExtra)\nlibrary(dplyr)\nlibrary(knitr)\nlibrary(unmarked)\nlibrary(lubridate)\nlibrary(jpeg)\nlibrary(stargazer)\nlibrary(xtable)\nlibrary(MuMIn)\nlibrary(ggplot2)\nlibrary(RCurl)\nlibrary(foreign)\nlibrary(caret)\n```\n\n\n```{r, message=FALSE, warning=FALSE, echo=FALSE, results='hide', cache=TRUE}\n#read rasters\nPNF<- readGDAL(\"~/new_bats/Rnew_bats/Bats_data_products/PNF.asc\")\nPNF<-raster (PNF)\nbc <- readGDAL(\"~/new_bats/Rnew_bats/Bats_data_products/bc.asc\")\nbc<-raster (bc)\nbb <- readGDAL(\"~/new_bats/Rnew_bats/Bats_data_products/bb.asc\")\nbb<-raster (bb)\nbs <- readGDAL(\"~/new_bats/Rnew_bats/Bats_data_products/bs.asc\")\nbs<-raster (bs)\ntopo <- readGDAL(\"~/new_bats/Rnew_bats/Bats_data_products/topo.asc\")\ntopo<-raster (topo)\ntopo<-topo*PNF\nVegetation_existing <- readGDAL(\"~/new_bats/Rnew_bats/Bats_data_products/Vegetation_existing.asc\")\nVegetation_existing<-raster (Vegetation_existing)\nFireReturnAll <- readGDAL(\"~/new_bats/Rnew_bats/Bats_data_products/FireReturnAll.asc\")\nFireReturnAll<-raster (FireReturnAll)\n```\n\n\n```{r, echo=FALSE, results='hide', warning=FALSE, cache=TRUE}\nroaddist.r<- readGDAL(\"~/new_bats/Rnew_bats/Bats_data_products/roaddist.asc\")\nroaddist.r<-raster (roaddist.r)\nroaddist.r<- roaddist.r*PNF\n```\n\n```{r,echo=FALSE,warning=FALSE,message=FALSE,results='hide', cache=TRUE}\nriverdist.r<- readGDAL(\"~/new_bats/Rnew_bats/Bats_data_products/riverdist.asc\")\nriverdist.r<-raster (riverdist.r)\nriverdist.r<- riverdist.r*PNF\nriverdist.r<- riverdist.r*PNF\n\n```\n\n```{r,echo=FALSE, warning=FALSE,message=FALSE}\nsampling.cov2 <- read.csv(\"~/new_bats/Rnew_bats/Bats_data_products/sampling.cov2.csv\")\nsampling.cov2<- sampling.cov2[,-1]\nsampling.cov2<- data.frame(sampling.cov2)\npreprocov <-preProcess(sampling.cov2[,1:8], method = c(\"center\",\"scale\"))\nsampling.cov2<-predict(preprocov, sampling.cov2[,1:8])\n\nDailycov3 <- read.csv(\"~/new_bats/Rnew_bats/Bats_data_products/Dailycov3.csv\")\nDailycov3 <- Dailycov3 [,-1]\n\n\npreproDaily <-preProcess(Dailycov3[,], method = c(\"knnImpute\"))\nDailycov3<-predict(preproDaily, Dailycov3)\n\nJulian<-Dailycov3[,1:3]\nMax.hum<-Dailycov3[,4:6]\nMax.temp<-Dailycov3[,7:9]\nMean.hum<-Dailycov3[,10:12]\nMean.temp<-Dailycov3[,13:15]\nMin.hum<-Dailycov3[,16:18]\nMin.temp<-Dailycov3[,19:21]\nSd.hum<-Dailycov3[,22:24]\nSd.temp<-Dailycov3[,25:27]\n\nDailycov3<- list(Julian,Max.hum, Max.temp, Mean.hum,Mean.temp, Min.hum, Min.temp, Sd.hum, Sd.temp)\nnames(Dailycov3) <- c(\"Julian\", \"Maxhum\",\"Maxtemp\",\"Meanhum\", \"Meantemp\",\"Minhum\",\"Mintemp\",\"sdhum\",\"sdtemp\")\n\n```\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE}\n\nPredictors <-stack(riverdist.r, roaddist.r, Vegetation_existing,  FireReturnAll, topo, bs,bc, bb)\nnames(Predictors)<-c(\"Distance to water\", \"Distance to road\",\"Existing vegetation\",\"Fire Interval\",\"Altitude\", \"Burn intensity soil\",\"Burn intensity Canopy\", \"Burn intensity basal\")\nPred.DF<-as.data.frame(Predictors)\nPred.DF<-predict(preprocov, new=Pred.DF)\n\nDistance.to.water <- PNF  # this will be the template\nDistance.to.water[] <- NA \nvalues(Distance.to.water)<-Pred.DF[,1]\n\nDistance.to.road <- PNF  # this will be the template\nDistance.to.road[] <- NA \nvalues(Distance.to.road)<-Pred.DF[,2]\n\nExisting.vegetation <- PNF  # this will be the template\nExisting.vegetation[] <- NA \nvalues(Existing.vegetation)<-Pred.DF[,3]\n\nFire.Interval <- PNF  # this will be the template\nFire.Interval[] <- NA \nvalues(Fire.Interval)<-Pred.DF[,4]\n\nAltitude <- PNF  # this will be the template\nAltitude[] <- NA \nvalues(Altitude)<-Pred.DF[,5]\n     \nBurn.intensity.soil <- PNF  # this will be the template\nBurn.intensity.soil[] <- NA \nvalues(Burn.intensity.soil)<-Pred.DF[,6]\n\nBurn.intensity.Canopy <- PNF  # this will be the template\nBurn.intensity.Canopy[] <- NA \nvalues(Burn.intensity.Canopy)<-Pred.DF[,7]\n\nBurn.intensity.basal <- PNF  # this will be the template\nBurn.intensity.basal[] <- NA \nvalues(Burn.intensity.basal)<-Pred.DF[,8]\n\nPredictors <-stack(Distance.to.water, Distance.to.road, Existing.vegetation,  Fire.Interval, Altitude, Burn.intensity.soil,Burn.intensity.Canopy, Burn.intensity.basal)\nnames(Predictors)<-c(\"Distance to water\", \"Distance to road\",\"Existing vegetation\",\"Fire Interval\",\"Altitude\", \"Burn intensity soil\",\"Burn intensity Canopy\", \"Burn intensity basal\")\n\n```\n\n```{r, echo=FALSE}\n#then add the data\nRESULTS <- read.csv(\"~/new_bats/Rnew_bats/Bats_data_products/RESULTS.csv\")\nRESULTS <- RESULTS[,-1]\nRESULTS$START.DATE<- dmy(as.character(RESULTS$START.DATE), tz = \"America/Los_Angeles\")\nRESULTS$END.DATE<- dmy(as.character(RESULTS$END.DATE), tz = \"America/Los_Angeles\")\n```\n\n\n\n\n#Results collected in the field \n\n\n```{r, echo=FALSE}\nplot(Predictors)\n```\n\n```{r,echo=FALSE, warning=FALSE,message=FALSE}\nResult2<-read.csv(\"~/new_bats/Rnew_bats/Bats_data_products/RESULTS2.csv\")\nResult2<- Result2[,-1]\n```\n\n\n\n\n#Maps showing the sampled Points\n\n```{r,echo=FALSE, warning=FALSE,message=FALSE}\nplot(PNF, legend=FALSE)\npoints(RESULTS$LONG, RESULTS$LAT, cex=0.5)\nmap.scale(-120.7, 39.5, relwidth = 0.15, metric = TRUE, ratio = FALSE,cex=0.7)\n```\n\n#Results of species prescence\n\nIn this area 0 means absence, and 1 means prescence. This table has for each site (ID), every specie and day, so for example if Mylu1=0, that means that for *Myotis lucifugus* (common name Little Brown bat, was detected on day one for that particular site).\n\n##Here is a key for bat species\n\n- *Myotis yumanensis* (Myyu)\n- *Myotis californicus* (Myca)\n- *Myotis ciliolabrum* (Myci)\n- *Myotis volans* (Myvo)\n- *Myotis lucifugus* (Mylu)\n- *Parastrellus hesperus* (Pahe)\n- *Lasiurus blossevillii* (Labo)\n- *Myotis evotis* (Myev)\n- *Antrozous pallidus*  **(Anpa)**\n- *Eptesicus fuscus* (Epfu)\n- *Lasionycteris noctivagans* (Lano)\n- *Myotis thysanodes* **(Myth)**\n- *Tadarida brasiliensis* (Tabr)\n- *Lasiurus cinereus* (Laci)\n- *Corynorhinus townsendii* **(Coto)**\n- *Euderma maculatum* (Euma)\n- *Eumops perotis* (Eupe)\n\n```{r,echo=FALSE, warning=FALSE,message=FALSE}\nBatOccu <- read.csv(\"~/new_bats/Rnew_bats/BatOccu.csv\")\n#print(BatOccu)\n```\n\n#Maps predicting the distribution of bats\n\n##Yuma myotis (*Myotis yumanensis*)\n\n```{r, echo=FALSE,message=FALSE}\nlibrary(unmarked)\n```\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE}\n#N=49a\nBatOccuMyYu<-BatOccu[,2:4]\n\nSimOccuMyYu2<-unmarkedFrameOccu(y = BatOccuMyYu, siteCovs =sampling.cov2, obsCovs=Dailycov3)\n\nmodel.Occu1.My.Yu2 <- occu(~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~  Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy + I(Burn.intensity.Canopy^2) + Burn.intensity.basal + I(Burn.intensity.basal^2),SimOccuMyYu2)\n\nselect.My.Yu2 <- dredge(model.Occu1.My.Yu2, rank = \"AICc\")\n\nbest2.My.Yu2<-get.models(select.My.Yu2, 1)[[1]]\nOccu1.layer.MyYu2 <- predict(best2.My.Yu2, type = \"state\", newdata=Predictors)\n\nbrks= c(0, 0.1, 0.2, 0.3, 0.4,0.5, 0.6,0.7, 0.8,0.9, 1)\ncols <- rev(terrain.colors(10))\nOccu1.layer.MyYu2<-Occu1.layer.MyYu2*PNF\nplot(Occu1.layer.MyYu2$layer.1, colNA=\"black\", main=\"Occupancy estimation for Yuma Myotis\",breaks=brks, lab.breaks=brks, col=cols, zlim=c(0,1))\n```\n\n```{r,echo=FALSE,results='asis', warning=FALSE,message=FALSE}\nlibrary(texreg)\nhtmlreg(extract(subset(select.My.Yu2, delta <= 2, recalc.weights = FALSE)))\n```\n\n```{r,echo=FALSE,cache=TRUE}\nyuma.stack <- stack(bs,bc, bb, Occu1.layer.MyYu2$layer.1)\n\nnames(yuma.stack)<-c(\"Burn intensity Soil\", \"Burn intensity Canopy\",\"Burn intensity Basal\", \"Occupancy\")\n\npairs (yuma.stack)\n```\n\n##California bat (*Myotis californicus*)\n\n\n```{r, echo=FALSE,message=FALSE}\nlibrary(unmarked)\n```\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE, results='hide'}\n#N=49\nBatOccuMyCa<-BatOccu[,5:7]\n```\n\n###Total model\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE}\n#N=49\n\nSimOccuMyCa2<-unmarkedFrameOccu(y = BatOccuMyCa, siteCovs =sampling.cov2, obsCovs=Dailycov3)\n\nmodel.Occu1.My.Ca2 <- occu(~ Julian +  Meanhum + Meantemp + sdhum + sdtemp ~ Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy + I(Burn.intensity.Canopy^2) + Burn.intensity.basal + I(Burn.intensity.basal^2), SimOccuMyCa2)\n\nselect.My.Ca2 <- dredge(model.Occu1.My.Ca2, rank = \"AICc\")\n\nbest2.My.Ca2<-get.models(select.My.Ca2, 1)[[1]]\nOccu1.layer.MyCa2 <- predict(best2.My.Ca2, type = \"state\", newdata=Predictors)\n\nOccu1.layer.MyCa2<-Occu1.layer.MyCa2*PNF\nplot(Occu1.layer.MyCa2$layer.1, colNA=\"black\", main=\"Occupancy estimation for California Bat\",breaks=brks, col=cols,lab.breaks=brks, zlim=c(0,1))\n```\n\n```{r,echo=FALSE,results='asis', warning=FALSE,message=FALSE}\nlibrary(texreg)\nhtmlreg(extract(subset(select.My.Ca2, delta <= 2, recalc.weights = FALSE)))\n```\n\n```{r,echo=FALSE,cache=TRUE}\nmyca.stack <- stack(bs,bc, bb, Occu1.layer.MyCa2$layer.1)\n\nnames(myca.stack)<-c(\"Burn intensity Soil\", \"Burn intensity Canopy\",\"Burn intensity Basal\", \"Occupancy\")\n\npairs (myca.stack)\n```\n\n##Western Small Footed Myotis (*Myotis ciliolabrum*)\n\n```{r, echo=FALSE,message=FALSE, results='asis'}\nlibrary(unmarked)\n```\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE, results='hide'}\n#N=49\nBatOccuMyCi<-BatOccu[,8:10]\n\n```\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE}\n#N=49\nSimOccuMyCi2<-unmarkedFrameOccu(y = BatOccuMyCi, siteCovs =sampling.cov2, obsCovs=Dailycov3)\n\nmodel.Occu1.My.Ci2 <- occu(~ Julian+ Meanhum + Meantemp + sdhum + sdtemp ~ Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy + I(Burn.intensity.Canopy^2) + Burn.intensity.basal + I(Burn.intensity.basal^2), SimOccuMyCi2)\n\n\nselect.My.Ci2 <- dredge(model.Occu1.My.Ci2, rank = \"AICc\")\n\nbest2.My.Ci2<-get.models(select.My.Ci2, 1)[[1]]\nOccu1.layer.MyCi2 <- predict(best2.My.Ci2, type = \"state\", newdata=Predictors)\n\nOccu1.layer.MyCi2<-Occu1.layer.MyCi2*PNF\nplot(Occu1.layer.MyCi2$layer.1, colNA=\"black\", main=\"Occupancy estimation for Western Small Footed Myotis\",breaks=brks, col=cols, lab.breaks=brks, zlim=c(0,1))\n```\n\n```{r,echo=FALSE,results='asis', warning=FALSE,message=FALSE}\nlibrary(texreg)\nhtmlreg(extract(subset(select.My.Ci2, delta <= 2, recalc.weights = FALSE)))\n```\n\n```{r,echo=FALSE,cache=TRUE}\nmyci.stack <- stack(bs,bc, bb, Occu1.layer.MyCi2$layer.1)\n\nnames(myci.stack)<-c(\"Burn intensity Soil\", \"Burn intensity Canopy\",\"Burn intensity Basal\", \"Occupancy\")\n\npairs (myci.stack)\n```\n\n##Hairy-winged bat (*Myotis volans*)\n\n```{r, echo=FALSE,message=FALSE}\nlibrary(unmarked)\n```\n\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE, results='hide'}\n#N=49\n\nBatOccuMyVo<-BatOccu[,11:13]\n```\n\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE}\n#N=49\nSimOccuMyVo2<-unmarkedFrameOccu(y = BatOccuMyVo, siteCovs =sampling.cov2, obsCovs=Dailycov3)\n\nmodel.Occu1.My.Vo2 <- occu(~ Julian + Meanhum + Meantemp ~  Burn.intensity.soil  + Burn.intensity.Canopy + Burn.intensity.basal,SimOccuMyVo2)\n\nselect.My.Vo2 <- dredge(model.Occu1.My.Vo2, rank = \"AICc\")\nbest2.My.Vo2<-get.models(select.My.Vo2, 1)[[1]]\nOccu1.layer.MyVo2 <- predict(best2.My.Vo2, type = \"state\", newdata=Predictors)\n\nOccu1.layer.MyVo2<-Occu1.layer.MyVo2*PNF\nplot(Occu1.layer.MyVo2$layer.1, colNA=\"black\", main=\"Occupancy estimation for Hairy-winged bat\",breaks=brks, col=cols, lab.breaks=brks, zlim=c(0,1))\n```\n\n```{r,echo=FALSE,results='asis', warning=FALSE,message=FALSE}\nlibrary(texreg)\nhtmlreg(extract(subset(select.My.Vo2, delta <= 2, recalc.weights = FALSE)))\n```\n\n```{r,echo=FALSE,cache=TRUE}\nmyvo.stack <- stack(bs,bc, bb, Occu1.layer.MyVo2$layer.1)\n\nnames(myvo.stack)<-c(\"Burn intensity Soil\", \"Burn intensity Canopy\",\"Burn intensity Basal\", \"Occupancy\")\n\npairs (myvo.stack)\n```\n\n##Little Brown bat (*Myotis lucifugus*)\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE, results='hide'}\n#N=49\nBatOccuMyLu<-BatOccu[,14:16]\n\n```\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE}\nSimOccuMyLu2<-unmarkedFrameOccu(y = BatOccuMyLu, siteCovs =sampling.cov2, obsCovs=Dailycov3)\n\nmodel.Occu1.My.Lu2 <- occu(~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~ Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy + I(Burn.intensity.Canopy^2) + Burn.intensity.basal +I(Burn.intensity.basal^2), SimOccuMyLu2)\n\n\nselect.My.Lu2 <- dredge(model.Occu1.My.Lu2, rank = \"AICc\")\n\nbest2.My.Lu2<-get.models(select.My.Lu2, 1)[[1]]\nOccu1.layer.MyLu2 <- predict(best2.My.Lu2, type = \"state\", newdata=Predictors)\n\nOccu1.layer.MyLu2<-Occu1.layer.MyLu2*PNF\nplot(Occu1.layer.MyLu2$layer.1, colNA=\"black\", main=\"Occupancy estimation for Little Brown Bat\",breaks=brks, col=cols, lab.breaks=brks, zlim=c(0,1))\n```\n\n```{r,echo=FALSE,results='asis', warning=FALSE,message=FALSE}\nlibrary(texreg)\nhtmlreg(extract(subset(select.My.Lu2, delta <= 2, recalc.weights = FALSE)))\n```\n\n```{r,echo=FALSE,cache=TRUE}\nmylu.stack <- stack(bs,bc, bb, Occu1.layer.MyLu2$layer.1)\n\nnames(mylu.stack)<-c(\"Burn intensity Soil\", \"Burn intensity Canopy\",\"Burn intensity Basal\", \"Occupancy\")\n\npairs (mylu.stack)\n```\n\n##Western Red Bat (*Lasiurus blossevillii*)\n\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE, results='hide'}\n#N=49\nBatOccuLaBl<-BatOccu[,20:22]\n```\n\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE}\n#N=49\n\nSimOccuLaBl2<-unmarkedFrameOccu(y = BatOccuLaBl, siteCovs =sampling.cov2, obsCovs=Dailycov3)\n\nmodel.Occu1.La.Bl2 <- occu(~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~ Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy + I(Burn.intensity.Canopy^2) + Burn.intensity.basal + I(Burn.intensity.basal^2) ,SimOccuLaBl2)\n\nselect.La.Bl2 <- dredge(model.Occu1.La.Bl2, rank = \"AICc\")\n\nbest2.La.Bl2<-get.models(select.La.Bl2, 1)[[1]]\nOccu1.layer.LaBl2 <- predict(best2.La.Bl2, type = \"state\", newdata=Predictors)\n\nOccu1.layer.LaBl2<-Occu1.layer.LaBl2*PNF\nplot(Occu1.layer.LaBl2$layer.1, colNA=\"black\", main=\"Occupancy estimation for Western Red Bat\",breaks=brks, col=cols, lab.breaks=brks, zlim=c(0,1))\n```\n\n```{r,echo=FALSE,results='asis', warning=FALSE,message=FALSE}\nlibrary(texreg)\nhtmlreg(extract(subset(select.La.Bl2, delta <= 2, recalc.weights = FALSE)))\n```\n\n```{r,echo=FALSE,cache=TRUE}\nlabl.stack <- stack(bs,bc, bb, Occu1.layer.LaBl2$layer.1)\n\nnames(labl.stack)<-c(\"Burn intensity Soil\", \"Burn intensity Canopy\",\"Burn intensity Basal\", \"Occupancy\")\n\npairs (labl.stack)\n```\n\n## Long-eared Bat (*Myotis evotis*)\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE, results='hide'}\n\n#N=49\n\nBatOccuMyEv<-BatOccu[,23:25]\n\n```\n\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE}\n#N=49\n\nSimOccuMyEv2<-unmarkedFrameOccu(y = BatOccuMyEv, siteCovs =sampling.cov2, obsCovs=Dailycov3)\n\nmodel.Occu1.My.Ev2 <- occu(~ Julian + Meanhum + Meantemp ~  Burn.intensity.soil + Burn.intensity.Canopy + Burn.intensity.basal, SimOccuMyEv2)\n\nselect.My.Ev2 <- dredge(model.Occu1.My.Ev2, rank = \"AICc\")\n\nbest2.My.Ev2<-get.models(select.My.Ev2, 1)[[1]]\nOccu1.layer.MyEv2 <- predict(best2.My.Ev2, type = \"state\", newdata=Predictors)\n\nOccu1.layer.MyEv2<-Occu1.layer.MyEv2*PNF\nplot(Occu1.layer.MyEv2$layer.1, colNA=\"black\", main=\"Occupancy estimation for Long Eared Bat\",breaks=brks, col=cols, lab.breaks=brks, zlim=c(0,1))\n```\n\n```{r,echo=FALSE,results='asis', warning=FALSE,message=FALSE}\nlibrary(texreg)\nhtmlreg(extract(subset(select.My.Ev2, delta <= 2, recalc.weights = FALSE)))\n```\n\n```{r,echo=FALSE,cache=TRUE}\nmyev.stack <- stack(bs,bc, bb, Occu1.layer.MyEv2$layer.1)\n\nnames(myev.stack)<-c(\"Burn intensity Soil\", \"Burn intensity Canopy\",\"Burn intensity Basal\", \"Occupancy\")\n\npairs (myev.stack)\n```\n\n\n## Pallid Bat (*Antrozous pallidus*)\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE, results='hide'}\n#N=49\nBatOccuAnPa<-BatOccu[,26:28]\n\n```\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE}\n#N=49\n\nSimOccuAnPa2<-unmarkedFrameOccu(y = BatOccuAnPa, siteCovs =sampling.cov2, obsCovs=Dailycov3)\n\nmodel.Occu1.An.Pa2 <- occu(~ Julian +Meanhum + Meantemp ~ Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy + I(Burn.intensity.Canopy^2) + Burn.intensity.basal + I(Burn.intensity.basal^2), SimOccuAnPa2)\n\nselect.An.Pa2 <- dredge(model.Occu1.An.Pa2, rank = \"AICc\")\n\nbest2.An.Pa2<-get.models(select.An.Pa2, 1)[[1]]\nOccu1.layer.AnPa2 <- predict(best2.An.Pa2, type = \"state\", newdata=Predictors)\n\nOccu1.layer.AnPa2<-Occu1.layer.AnPa2*PNF\nplot(Occu1.layer.AnPa2$layer.1, colNA=\"black\", main=\"Occupancy estimation for Pallid Bat\",breaks=brks, col=cols, lab.breaks=brks, zlim=c(0,1))\n```\n\n```{r,echo=FALSE,results='asis', warning=FALSE,message=FALSE}\nlibrary(texreg)\nhtmlreg(extract(subset(select.An.Pa2, delta <= 2, recalc.weights = FALSE)))\n```\n\n```{r,echo=FALSE,cache=TRUE}\nanpa.stack <- stack(bs,bc, bb, Occu1.layer.AnPa2$layer.1)\n\nnames(anpa.stack)<-c(\"Burn intensity Soil\", \"Burn intensity Canopy\",\"Burn intensity Basal\", \"Occupancy\")\n\npairs(anpa.stack)\n```\n\n###Fringed Bat (*Myotis thysanoides*)\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE, results='hide'}\n#N=49\nBatOccuMyTh<-BatOccu[,35:37]\n\n```\n\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE}\n#N=49\nSimOccuMyTh2<-unmarkedFrameOccu(y = BatOccuMyTh, siteCovs =sampling.cov2, obsCovs=Dailycov3)\n\nmodel.Occu1.My.Th2 <- occu(~ Julian +Meanhum + Meantemp + sdhum + sdtemp ~  Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy + I(Burn.intensity.Canopy^2) + Burn.intensity.basal +I(Burn.intensity.basal^2) ,SimOccuMyTh2)\n\n\nselect.My.Th2 <- dredge(model.Occu1.My.Th2, rank = \"AICc\")\n\nbest2.My.Th2<-get.models(select.My.Th2, 1)[[1]]\nOccu1.layer.MyTh2 <- predict(best2.My.Th2, type = \"state\", newdata=Predictors)\n\nOccu1.layer.MyTh2<-Occu1.layer.MyTh2*PNF\nplot(Occu1.layer.MyTh2$layer.1, colNA=\"black\", main=\"Occupancy estimation for Fringed Bat\",breaks=brks, col=cols, lab.breaks=brks, zlim=c(0,1))\n```\n\n```{r,echo=FALSE,results='asis', warning=FALSE,message=FALSE}\nlibrary(texreg)\nhtmlreg(extract(subset(select.My.Th2, delta <= 2, recalc.weights = FALSE)))\n```\n\n```{r,echo=FALSE,cache=TRUE}\nmyth.stack <- stack(bs,bc, bb, Occu1.layer.MyTh2$layer.1)\n\nnames(myth.stack)<-c(\"Burn intensity Soil\", \"Burn intensity Canopy\",\"Burn intensity Basal\", \"Occupancy\")\n\npairs(myth.stack)\n```\n\n##Townsendâ€™s Long-eared Bat (*Corynorhinus townsendii*)\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE, results='hide'}\n#N=49\nBatOccuCoTo<-BatOccu[,44:46]\n```\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE}\n#N=49\nSimOccuCoTo2<-unmarkedFrameOccu(y = BatOccuCoTo, siteCovs =sampling.cov2, obsCovs=Dailycov3)\n\nmodel.Occu1.Co.To2 <- occu(~ Julian + Meanhum + Meantemp  ~ Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy + I(Burn.intensity.Canopy^2) + Burn.intensity.basal + I(Burn.intensity.basal^2), SimOccuCoTo2)\n\n\nselect.Co.To2 <- dredge(model.Occu1.Co.To2, rank = \"AICc\")\n\nbest2.Co.To2<-get.models(select.Co.To2, 1)[[1]]\nOccu1.layer.CoTo2 <- predict(best2.Co.To2, type = \"state\", newdata=Predictors)\n\nOccu1.layer.CoTo2<-Occu1.layer.CoTo2*PNF\nplot(Occu1.layer.CoTo2$layer.1, colNA=\"black\", main=\"Occupancy estimation for Townsend big eared bat\",breaks=brks, col=cols, lab.breaks=brks, zlim=c(0,1))\n```\n\n```{r,echo=FALSE,results='asis', warning=FALSE,message=FALSE}\nlibrary(texreg)\nhtmlreg(extract(subset(select.Co.To2, delta <= 2, recalc.weights = FALSE)))\n```\n\n```{r,echo=FALSE,cache=TRUE}\ncoto.stack <- stack(bs,bc, bb, Occu1.layer.CoTo2$layer.1)\n\nnames(coto.stack)<-c(\"Burn intensity Soil\", \"Burn intensity Canopy\",\"Burn intensity Basal\", \"Occupancy\")\n\npairs(coto.stack)\n```\n\n##The western pipistrelle (*Parastrellus hesperus*)\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE, results='hide'}\n#N=49\nBatOccuPaHe<-BatOccu[,17:19]\n```\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE}\n#N=49\nSimOccuPaHe2<-unmarkedFrameOccu(y = BatOccuPaHe, siteCovs =sampling.cov2, obsCovs=Dailycov3)\n\n\n#model.Occu1.Pa.He2 <- occu(~ Julian + Meanhum + Meantemp  ~ Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy + Burn.intensity.Canopy2 + Burn.intensity.basal +Burn.intensity.basal2, SimOccuPaHe2)\n\n\n#select.Pa.He2 <- dredge(model.Occu1.Pa.He2, rank = \"AICc\")\n```\n\n```{r, echo=FALSE, cache= TRUE, results='hide', message=FALSE,warning=FALSE}\n#best2.Pa.He2<-get.models(select.Pa.He2, 1)[[1]]\n#Occu1.layer.PaHe2 <- predict(best2.Pa.He2, type = \"state\", newdata=Predictors)\n```\n\n```{r, echo=FALSE,warning=FALSE,message=FALSE}\n#Occu1.layer.PaHe2<-Occu1.layer.PaHe2*PNF\n#plot(Occu1.layer.PaHe2$layer.1, colNA=\"black\", main=\"Occupancy estimation for Pipistrel\",breaks=brks, col=cols, lab.breaks=brks, zlim=c(0,1))\n```\n\n```{r,echo=FALSE,results='asis', warning=FALSE,message=FALSE}\n#library(texreg)\n#htmlreg(extract(subset(select.Pa.He2, delta <= 2, recalc.weights = FALSE)))\n```\n\n```{r,echo=FALSE,cache=TRUE}\n#pahe.stack <- stack(bs,bc, bb, Occu1.layer.PaHe2$layer.1)\n\n#names(pahe.stack)<-c(\"Burn intensity Soil\", \"Burn intensity Canopy\",\"Burn intensity Basal\", \"Occupancy\")\n\n#pairs(pahe.stack)\n```\n\n##big brown bat (*Eptesicus fuscus*)\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE, results='hide'}\n#N=49\nBatOccuEpFu<-BatOccu[,29:31]\n```\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE}\n#N=49\nSimOccuEpFu2<-unmarkedFrameOccu(y = BatOccuEpFu, siteCovs =sampling.cov2, obsCovs=Dailycov3)\n\nmodel.Occu1.Ep.Fu2 <- occu(~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~ Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy + I(Burn.intensity.Canopy^2) + Burn.intensity.basal +I(Burn.intensity.basal^2), SimOccuEpFu2)\n\n\nselect.Ep.Fu2 <- dredge(model.Occu1.Ep.Fu2, rank = \"AICc\")\n\nbest2.Ep.Fu2<-get.models(select.Ep.Fu2, 1)[[1]]\nOccu1.layer.EpFu2 <- predict(best2.Ep.Fu2, type = \"state\", newdata=Predictors)\n\nOccu1.layer.EpFu2<-Occu1.layer.EpFu2*PNF\nplot(Occu1.layer.EpFu2$layer.1, colNA=\"black\", main=\"Occupancy estimation for Big Brown Bat\",breaks=brks, col=cols, lab.breaks=brks, zlim=c(0,1))\n```\n\n```{r,echo=FALSE,results='asis', warning=FALSE,message=FALSE}\nlibrary(texreg)\nhtmlreg(extract(subset(select.Ep.Fu2, delta <= 2, recalc.weights = FALSE)))\n```\n\n```{r,echo=FALSE,cache=TRUE}\nepfu.stack <- stack(bs,bc, bb, Occu1.layer.EpFu2$layer.1)\n\nnames(epfu.stack)<-c(\"Burn intensity Soil\", \"Burn intensity Canopy\",\"Burn intensity Basal\", \"Occupancy\")\n\npairs(epfu.stack)\n```\n\n##silver-haired bat (*Lasionycteris noctivagans*)\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE, results='hide'}\n#N=49\nBatOccuLaNo<-BatOccu[,32:34]\n```\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE}\n#N=49\nSimOccuLaNo2<-unmarkedFrameOccu(y = BatOccuLaNo, siteCovs =sampling.cov2, obsCovs=Dailycov3)\n\nmodel.Occu1.La.No2 <- occu(~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~  Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy + I(Burn.intensity.Canopy^2) + Burn.intensity.basal + (Burn.intensity.basal^2), SimOccuLaNo2)\n\n\nselect.La.No2 <- dredge(model.Occu1.La.No2, rank = \"AICc\")\n\nbest2.La.No2<-get.models(select.La.No2, 1)[[1]]\nOccu1.layer.LaNo2 <- predict(best2.La.No2, type = \"state\", newdata=Predictors)\n\nOccu1.layer.LaNo2<-Occu1.layer.LaNo2*PNF\nplot(Occu1.layer.LaNo2$layer.1, colNA=\"black\", main=\"Occupancy estimation for Silver Haired Bat\",breaks=brks, col=cols, lab.breaks=brks, zlim=c(0,1))\n```\n\n```{r,echo=FALSE,results='asis', warning=FALSE,message=FALSE}\nlibrary(texreg)\nhtmlreg(extract(subset(select.La.No2, delta <= 2, recalc.weights = FALSE)))\n```\n\n```{r,echo=FALSE,cache=TRUE}\nlano.stack <- stack(bs,bc, bb, Occu1.layer.LaNo2$layer.1)\n\nnames(lano.stack)<-c(\"Burn intensity Soil\", \"Burn intensity Canopy\",\"Burn intensity Basal\", \"Occupancy\")\n\npairs(lano.stack)\n```\n\n##Brazilian free-tailed bat (*Tadarida brasiliensis*)\n\n```{r,echo=FALSE, warning=FALSE,message=FALSE}\nBatOccuTaBr<-BatOccu[,38:40]\n```\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE}\n#N=49\nSimOccuTaBr2<-unmarkedFrameOccu(y = BatOccuTaBr, siteCovs =sampling.cov2, obsCovs=Dailycov3)\n\n\nmodel.Occu1.Ta.Br2 <- occu(~ Julian + Meanhum + Meantemp  ~ Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy +  I(Burn.intensity.Canopy^2) + Burn.intensity.basal + I(Burn.intensity.basal^2), SimOccuTaBr2)\n\n\nselect.Ta.Br2 <- dredge(model.Occu1.Ta.Br2, rank = \"AICc\")\n\nbest2.Ta.Br2<-get.models(select.Ta.Br2, 1)[[1]]\nOccu1.layer.TaBr2 <- predict(best2.Ta.Br2, type = \"state\", newdata=Predictors)\n\nOccu1.layer.TaBr2<-Occu1.layer.TaBr2*PNF\nplot(Occu1.layer.TaBr2$layer.1, colNA=\"black\", main=\"Occupancy estimation for Brazilian free-tailed bat\",breaks=brks, col=cols, lab.breaks=brks, zlim=c(0,1))\n```\n\n```{r,echo=FALSE,results='asis', warning=FALSE,message=FALSE}\nlibrary(texreg)\nhtmlreg(extract(subset(select.Ta.Br2, delta <= 2, recalc.weights = FALSE)))\n```\n\n```{r,echo=FALSE,cache=TRUE}\ntabr.stack <- stack(bs,bc, bb, Occu1.layer.TaBr2$layer.1)\n\nnames(tabr.stack)<-c(\"Burn intensity Soil\", \"Burn intensity Canopy\",\"Burn intensity Basal\", \"Occupancy\")\n\npairs(tabr.stack)\n```\n\n##hoary bat (*Lasiurus cinereus*)\n\n\n```{r,echo=FALSE, warning=FALSE,message=FALSE}\nBatOccuLaCi<-BatOccu[,41:43]\n```\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE}\n#N=49\nSimOccuLaCi2<-unmarkedFrameOccu(y = BatOccuLaCi, siteCovs =sampling.cov2, obsCovs=Dailycov3)\n\nmodel.Occu1.La.Ci2 <- occu(~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~ Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy + (Burn.intensity.Canopy^2) + Burn.intensity.basal + I(Burn.intensity.basal^2), SimOccuLaCi2)\n\n\nselect.La.Ci2 <- dredge(model.Occu1.La.Ci2, rank = \"AICc\")\n\nbest2.La.Ci2<-get.models(select.La.Ci2, 1)[[1]]\nOccu1.layer.LaCi2 <- predict(best2.La.Ci2, type = \"state\", newdata=Predictors)\n\nOccu1.layer.LaCi2<-Occu1.layer.LaCi2*PNF\nplot(Occu1.layer.LaCi2$layer.1, colNA=\"black\", main=\"Occupancy estimation for Hoary Bat\",breaks=brks, col=cols, lab.breaks=brks, zlim=c(0,1))\n```\n\n```{r,echo=FALSE,results='asis', warning=FALSE,message=FALSE}\nlibrary(texreg)\nhtmlreg(extract(subset(select.La.Ci2, delta <= 2, recalc.weights = FALSE)))\n```\n\n```{r,echo=FALSE,cache=TRUE}\nlaci.stack <- stack(bs,bc, bb, Occu1.layer.LaCi2$layer.1)\n\nnames(laci.stack)<-c(\"Burn intensity Soil\", \"Burn intensity Canopy\",\"Burn intensity Basal\", \"Occupancy\")\n\npairs(laci.stack)\n```\n\n##Spotted bat (*Euderma maculatum*)\n\n```{r,echo=FALSE, warning=FALSE,message=FALSE}\nBatOccuEuMa<-BatOccu[,47:49]\n```\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE}\n#N=49\nSimOccuEuMa2<-unmarkedFrameOccu(y = BatOccuEuMa, siteCovs =sampling.cov2, obsCovs=Dailycov3)\n\nmodel.Occu1.Eu.Ma2 <- occu(~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~ Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy + I(Burn.intensity.Canopy^2) + Burn.intensity.basal +I(Burn.intensity.basal^2), SimOccuEuMa2)\n\n\nselect.Eu.Ma2 <- dredge(model.Occu1.Eu.Ma2, rank = \"AICc\")\n\nbest2.Eu.Ma2<-get.models(select.Eu.Ma2, 1)[[1]]\nOccu1.layer.EuMa2 <- predict(best2.Eu.Ma2, type = \"state\", newdata=Predictors)\n\nOccu1.layer.EuMa2<-Occu1.layer.EuMa2*PNF\nplot(Occu1.layer.EuMa2$layer.1, colNA=\"black\", main=\"Occupancy estimation for Spotted Bat\",breaks=brks, col=cols, lab.breaks=brks, zlim=c(0,1))\n```\n\n```{r,echo=FALSE,results='asis', warning=FALSE,message=FALSE}\nlibrary(texreg)\nhtmlreg(extract(subset(select.Eu.Ma2, delta <= 2, recalc.weights = FALSE)))\n```\n\n```{r,echo=FALSE,cache=TRUE}\neuma.stack <- stack(bs,bc, bb, Occu1.layer.EuMa2$layer.1)\n\nnames(euma.stack)<-c(\"Burn intensity Soil\", \"Burn intensity Canopy\",\"Burn intensity Basal\", \"Occupancy\")\n\npairs(euma.stack)\n```\n\n## western mastiff bat (*Eumops perotis*)\n\n```{r,echo=FALSE, warning=FALSE,message=FALSE}\nBatOccuEuPe<-BatOccu[,50:52]\n```\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE}\n#N=49\n\n\nsampling.cov3<-data.frame(scale(sampling.cov2))\nSimOccuEuPe2<-unmarkedFrameOccu(y = BatOccuEuPe, siteCovs =sampling.cov2, obsCovs=Dailycov3)\n\nmodel.Occu1.Eu.Pe2 <- occu(~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~ Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy + I(Burn.intensity.Canopy^2) + Burn.intensity.basal + I(Burn.intensity.basal^2), SimOccuEuPe2)\n\n\nselect.Eu.Pe2 <- dredge(model.Occu1.Eu.Pe2, rank = \"AICc\")\n\nbest2.Eu.Pe2<-get.models(select.Eu.Pe2, 1)[[1]]\nOccu1.layer.EuPe2 <- predict(best2.Eu.Pe2, type = \"state\", newdata=Predictors)\n\nOccu1.layer.EuPe2<-Occu1.layer.EuPe2*PNF\nplot(Occu1.layer.EuPe2$layer.1, colNA=\"black\", main=\"Occupancy estimation for western mastiff bat\",breaks=brks, col=cols, lab.breaks=brks, zlim=c(0,1))\n```\n\n```{r,echo=FALSE,results='asis', warning=FALSE,message=FALSE}\nlibrary(texreg)\nhtmlreg(extract(subset(select.Eu.Pe2, delta <= 2, recalc.weights = FALSE)))\nwrite.csv(sampling.cov2, \"yahoo.csv\")\n```\n\n```{r,echo=FALSE,cache=TRUE}\neupe.stack <- stack(bs,bc, bb, Occu1.layer.EuPe2$layer.1)\n\nnames(eupe.stack)<-c(\"Burn intensity Soil\", \"Burn intensity Canopy\",\"Burn intensity Basal\", \"Occupancy\")\n\npairs(eupe.stack)\n```\n\n#Relationships between different species of Bats\n\n\n```{r,echo=FALSE, cache=TRUE}\n#N=49a\n#AllBats<-stack(Occu1.layer.MyYu$layer.1,Occu1.layer.MyCa$layer.1,Occu1.layer.MyCi$layer.1,Occu1.layer.MyVo$layer.1,Occu1.layer.MyLu$layer.1, Occu1.layer.LaBl$layer.1, Occu1.layer.MyEv$layer.1, Occu1.layer.AnPa$layer.1, Occu1.layer.MyTh$layer.1, Occu1.layer.CoTo$layer.1)`\n#names(AllBats)<-c(\"Yuma Myotis\", \"California Bat\",\"Small Footed Myotis\", \"Hairy-winged bat\" ,\"Little Brown Bat\", \"Western Red Bat\", \"Long-eared Bat\", \"Pallid Bat\", \"Fringed Bat\", \"Townsend's big-eared Bat\")\n#plot(AllBats, breaks=brks, col=cols, lab.breaks=brks, zlim=c(0,1), colNA=\"black\") \n#pairs(AllBats, xlim=c(0,1), ylim=c(0,1))\n```\n\n```{r,echo=FALSE, cache=TRUE}\n#N=49a\n#AllBats<-stack(Occu1.layer.MyYu2$layer.1, Occu1.layer.MyCa2$layer.1, Occu1.layer.MyCi2$layer.1,Occu1.layer.MyVo2$layer.1,Occu1.layer.MyLu2$layer.1, Occu1.layer.LaBl2$layer.1, Occu1.layer.MyEv2$layer.1,Occu1.layer.AnPa2$layer.1, Occu1.layer.MyTh2$layer.1, Occu1.layer.CoTo2$layer.1, Occu1.layer.EpFu2$layer.1, Occu1.layer.LaNo2$layer.1, Occu1.layer.TaBr2$layer.1, Occu1.layer.LaCi2$layer.1, Occu1.layer.EuMa2$layer.1,Occu1.layer.EuPe2$layer.1)\n#names(AllBats)<-c(\"Yuma Myotis\", \"California bat\",\"Small Footed Myotis\", \"Hairy-winged bat\" ,\"Little Brown Bat\", \"Western Red Bat\",\"Long-eared Bat\" ,\"Pallid Bat\", \"Fringed Bat\", \"Townsend's big-eared Bat\", \"Big Brow Bat\",\"Silver-Haired Bat\", \"Brazilian free-tailed bat\", \"Hoary Bat\", \"Spotted bat\", \" western mastiff bat\")\n#plot(AllBats, breaks=brks, col=cols, lab.breaks=brks, zlim=c(0,1), colNA=\"black\") \n#pairs(AllBats, xlim=c(0,1), ylim=c(0,1))\n```\n\n#Fire bats\n\n\n```{r,echo=FALSE, cache=TRUE}\n#N=49a\nFireBats<-stack(Occu1.layer.MyYu2$layer.1, Occu1.layer.MyCi2$layer.1, Occu1.layer.MyLu2$layer.1, Occu1.layer.LaBl2$layer.1, Occu1.layer.MyEv2$layer.1,Occu1.layer.AnPa2$layer.1, Occu1.layer.CoTo2$layer.1, Occu1.layer.EpFu2$layer.1, Occu1.layer.LaNo2$layer.1, Occu1.layer.TaBr2$layer.1, Occu1.layer.EuPe2$layer.1)\nnames(FireBats)<-c(\"Yuma Myotis\",\"Small Footed Myotis\",\"Little Brown Bat\", \"Western Red Bat\",\"Long-eared Bat\" ,\"Pallid Bat\", \"Townsend's big-eared Bat\", \"Big Brow Bat\",\"Silver-Haired Bat\", \"Brazilian free-tailed bat\", \" western mastiff bat\")\nplot(FireBats, breaks=brks, col=cols, lab.breaks=brks, zlim=c(0,1), colNA=\"black\") \npairs(FireBats, xlim=c(0,1), ylim=c(0,1))\n```\n\n\n```{r,echo=FALSE, cache=TRUE}\nlevelplot(FireBats, col.regions = rev(terrain.colors(99)), colorkey = list(space = \"bottom\"))\n```\n\n\n```{r, echo=FALSE, cache=TRUE}\nfire <- readGDAL(\"~/new_bats/Rnew_bats/Bats_data_products/fire.asc\")\nfire<-raster (fire)\n\nnot.fire <- readGDAL(\"~/new_bats/Rnew_bats/Bats_data_products/not_fire.asc\")\nnot.fire<-raster (not.fire)\n\nfire<- reclassify(fire, cbind(0, NA))\nplot(fire)\nplot(not.fire)\n\nbats.with.fire1<-FireBats*fire\nbats.without.fire1<-FireBats*not.fire\n\nnames(bats.with.fire1)<-c(\"Yuma Myotis\",\"Small Footed Myotis\",\"Little Brown Bat\", \"Western Red Bat\",\"Long-eared Bat\" ,\"Pallid Bat\", \"Townsend's big-eared Bat\", \"Big Brow Bat\",\"Silver-Haired Bat\", \"Brazilian free-tailed bat\", \" western mastiff bat\")\n\n\nnames(bats.without.fire1)<-c(\"Yuma Myotis\",\"Small Footed Myotis\",\"Little Brown Bat\", \"Western Red Bat\",\"Long-eared Bat\" ,\"Pallid Bat\", \"Townsend's big-eared Bat\", \"Big Brow Bat\",\"Silver-Haired Bat\", \"Brazilian free-tailed bat\", \" western mastiff bat\")\n\nplot(bats.with.fire1, breaks=brks, col=cols, lab.breaks=brks, zlim=c(0,1), colNA=\"black\", main= \"Fire\")\nplot(bats.without.fire1, breaks=brks, col=cols, lab.breaks=brks, zlim=c(0,1), colNA=\"black\", main= \"Not Fire\")\n```\n\n```{r,echo=FALSE, cache=TRUE}\nlevelplot(bats.with.fire1, col.regions = rev(terrain.colors(99)), colorkey = list(space = \"bottom\"))\n\nlevelplot(bats.without.fire1, col.regions = rev(terrain.colors(99)), colorkey = list(space = \"bottom\"))\n```\n\n```{r, echo=FALSE, cache=TRUE}\nwith.fire1<-cellStats(bats.with.fire1, 'mean', na.rm=TRUE)\nwithout.fire1<-cellStats(bats.without.fire1, 'mean', na.rm=TRUE)\nwith.fire.sd1<-cellStats(bats.with.fire1, 'sd', na.rm=TRUE)\n\nwith.fire1<-data.frame(with.fire1)\nwith.fire1<-data.frame(with.fire1)\nwithout.fire1<-data.frame(without.fire1)\n\nfire.response1<-cbind(with.fire1,without.fire1, with.fire.sd1)\nkable(fire.response1, digits=2)\nwrite.csv(fire.response1, file=\"Fire_response.csv\")\n```\n\n```{r,echo=FALSE, cache=TRUE}\nmyyu<-as.vector(subset(bats.with.fire1,1))\nmyyu<-myyu[!is.na(myyu)]\nt.test(myyu, alternative = \"two.sided\", mu = fire.response1$without.fire[1])\nmyyu <-(myyu-fire.response1$without.fire[1])\n\nmyci<-as.vector(subset(bats.with.fire1,2))\nmyci<-myci[!is.na(myci)]\nt.test(myci, alternative = \"two.sided\", mu = fire.response1$without.fire[2])\nmyci <-(myci-fire.response1$without.fire[2])\n\nmylu<-as.vector(subset(bats.with.fire1,3))\nmylu<-mylu[!is.na(mylu)]\nt.test(mylu, alternative = \"two.sided\", mu = fire.response1$without.fire[3])\nmylu <-(mylu-fire.response1$without.fire[3])\n\nlabl<-as.vector(subset(bats.with.fire1,4))\nlabl<-labl[!is.na(labl)]\nt.test(labl, alternative = \"two.sided\", mu = fire.response1$without.fire[4])\nlabl <-(labl-fire.response1$without.fire1[4])\n\nmyev<-as.vector(subset(bats.with.fire1,5))\nmyev<-myev[!is.na(myev)]\nt.test(myev, alternative = \"two.sided\", mu = fire.response1$without.fire[5])\nmyev <-(myev-fire.response1$without.fire[5])\n\nanpa<-as.vector(subset(bats.with.fire1,6))\nanpa<-anpa[!is.na(anpa)]\nt.test(anpa, alternative = \"two.sided\", mu = fire.response1$without.fire[6])\nanpa <-(anpa-fire.response1$without.fire[6])\n\ncoto<-as.vector(subset(bats.with.fire1,7))\ncoto<-coto[!is.na(coto)]\nt.test(coto, alternative = \"two.sided\", mu = fire.response1$without.fire[7])\ncoto <-(coto-fire.response1$without.fire[7])\n\nepfu<-as.vector(subset(bats.with.fire1,8))\nepfu<-epfu[!is.na(epfu)]\nt.test(epfu, alternative = \"two.sided\", mu = fire.response1$without.fire[8])\nepfu <-(epfu-fire.response1$without.fire[8])\n\nlano<-as.vector(subset(bats.with.fire1,9))\nlano<-lano[!is.na(lano)]\nt.test(lano, alternative = \"two.sided\", mu = fire.response1$without.fire[9])\nlano <-(lano-fire.response1$without.fire[9])\n\ntabr<-as.vector(subset(bats.with.fire1,10))\ntabr<-tabr[!is.na(tabr)]\nt.test(tabr, alternative = \"two.sided\", mu = fire.response1$without.fire[10])\ntabr <-(tabr-fire.response1$without.fire[10])\n\n\neupe<-as.vector(subset(bats.with.fire1,11))\neupe<-eupe[!is.na(eupe)]\nt.test(eupe, alternative = \"two.sided\", mu = fire.response1$without.fire[11])\neupe <-(eupe-fire.response1$without.fire[11])\n\nbr<-cbind.data.frame(myyu,myci, mylu, labl, myev, anpa, coto, epfu, lano, tabr, eupe)\npar(las = 2)\nboxplot(br, outline=FALSE, cex= 0.8, ylab=\"Difference from unburned occupancy\")\nabline(h=0)\n\n```\n\n```{r,echo=FALSE, cache=TRUE}\nmyyu3<- cbind.data.frame(myyu, rep(\"myyu\", times=(length(myyu))))\ncolnames(myyu3)<-c(\"Occu\", \"Species\")\n\nmyci3<- cbind.data.frame(myci, rep(\"myci\", times=(length(myci))))\ncolnames(myci3)<-c(\"Occu\", \"Species\")\n\nmylu3<- cbind.data.frame(mylu, rep(\"mylu\", times=(length(mylu))))\ncolnames(mylu3)<-c(\"Occu\", \"Species\")\n\nlabl3<- cbind.data.frame(labl, rep(\"labl\", times=(length(labl))))\ncolnames(labl3)<-c(\"Occu\", \"Species\")\n\nmyev3<- cbind.data.frame(myev, rep(\"myev\", times=(length(myev))))\ncolnames(myev3)<-c(\"Occu\", \"Species\")\n\nanpa3<- cbind.data.frame(anpa, rep(\"anpa\", times=(length(anpa))))\ncolnames(anpa3)<-c(\"Occu\", \"Species\")\n\ncoto3<- cbind.data.frame(coto, rep(\"coto\", times=(length(coto))))\ncolnames(coto3)<-c(\"Occu\", \"Species\")\n\nepfu3<- cbind.data.frame(epfu, rep(\"epfu\", times=(length(epfu))))\ncolnames(epfu3)<-c(\"Occu\", \"Species\")\n\nlano3<- cbind.data.frame(lano, rep(\"lano\", times=(length(lano))))\ncolnames(lano3)<-c(\"Occu\", \"Species\")\n\ntabr3<- cbind.data.frame(tabr, rep(\"tabr\", times=(length(tabr))))\ncolnames(tabr3)<-c(\"Occu\", \"Species\")\n\neupe3<- cbind.data.frame(eupe, rep(\"eupe\", times=(length(eupe))))\ncolnames(eupe3)<-c(\"Occu\", \"Species\")\n\nbr3<- rbind(myyu3, myci3, mylu3, labl3, myev3, anpa3, coto3, epfu3, lano3, tabr3, eupe3)\nbr3$Species<-as.factor(br3$Species)\n\ng<-ggplot(br3, aes(x=Species, y=Occu))\ng+geom_jitter(alpha=0.2, aes(color=Species), position = position_jitter(width = 0.1))+theme_bw()+geom_violin(alpha=0.7, color=\"gray\",scale = \"width\")+ stat_summary(fun.y=mean, geom=\"point\", shape=18, size=3, color=\"black\")+ geom_hline(yintercept = 0)+theme(legend.position=\"none\")\n\n\ng+geom_violin(alpha=0.5, color=\"gray\",scale = \"width\")+theme_bw()+ stat_summary(fun.y=mean, geom=\"point\", shape=18, size=3, color=\"black\")+ geom_hline(yintercept = 0)\n\n\ng<-ggplot(br3, aes(x=Species, y=Occu))\ng+geom_jitter(alpha=0.2, aes(color=\"grey\"), position = position_jitter(width = 0.1))+theme_bw()+geom_violin(alpha=0.7, color=\"gray\",scale = \"width\")+ stat_summary(fun.y=mean, geom=\"point\", shape=18, size=3, color=\"black\")+ geom_hline(yintercept = 0)+theme(legend.position=\"none\")\n\n```\n\n```{r, cache=TRUE}\nlibrary(vioplot)\nvioplot(myyu,myci, mylu, labl, myev, anpa, coto, epfu, lano, tabr, eupe, col=\"grey\")\n```\n\n\n#**The End**\n\n\n\n```{r,echo=FALSE, warning=FALSE,message=FALSE, cache=TRUE}\n\nbrickses=c(0,1.01,4)\ncolores=c(\"chartreuse4\", \"darkorange2\")\nplot(PNF, legend=FALSE)\nplot((PNF+fire), legend=FALSE, breaks=brickses, col=colores, add=TRUE)\npoints(RESULTS$LONG, RESULTS$LAT, cex=0.5)\nmap.scale(-120.7, 39.5, relwidth = 0.15, metric = TRUE, ratio = FALSE,cex=0.7)\n```\n\n```{r, echo=TRUE}\n#valuetable <- getValues(AllLayers2)\n#km1 <- kmeans(na.omit(valuetable), centers = 5, iter.max = 100, nstart = 10)\n# create a blank raster with default values of 0\n#rNA <- setValues(raster(AllLayers2), 0)\n#for(i in 1:nlayers(AllLayers2)){\n  #rNA[is.na(AllLayers2[[i]])] <- 1\n#}\n# convert rNA to an integer vector\n#rNA <- getValues(rNA)\n# convert valuetable to a data.frame\n#valuetable <- as.data.frame(valuetable)\n# if rNA is a 0, assign the cluster value at that position\n#valuetable$class[rNA==0] <- km1$cluster\n# if rNA is a 1, assign an NA at that position\n#valuetable$class[rNA==1] <- NA\n# create a blank raster\n#classes1 <- raster(AllLayers2)\n# assign values from the 'class' column of valuetable\n#classes1 <- setValues(classes1, valuetable$class)\n#plot(classes1, legend=TRUE, colNA=\"black\")\n#More info on how to do this clasification in *https://geoscripting-wur.github.io/AdvancedRasterAnalysis/*\n```\n\n```{r}\nbest2.My.Yu2\n\nsummary(best2.My.Yu2)\n\nnames(best2.My.Yu2)\n\ngetP(best2.My.Yu2)\n\nbest2.My.Yu2['state']\n\ncoef(best2.My.Yu2, type='state')\n\n# Variance-covariance matrix\nvcov(best2.My.Yu2, type='state')\n\n# Confidence intervals using profiled likelihood\nconfint(best2.My.Yu2, type='state', method='profile')\n\n# Expected values\nfitted(best2.My.Yu2)\n\nlogLik(best2.My.Yu2)\n\n\n\n# Predicted abundance at specified covariate values\n\n\n# Assess goodness-of-fit\nparboot(best2.My.Yu2)\nplot(best2.My.Yu2)\n\n```\n",
    "created" : 1452020311367.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "414|76|417|3|\n",
    "hash" : "972398609",
    "id" : "5FA0FADA",
    "lastKnownWriteTime" : 1452012684,
    "path" : "~/new_bats/Rnew_bats/Firesummary2.Rmd",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "type" : "r_markdown"
}