library(caret)
library(dismo)
library(vegan)
sampling.cov2 <- read.csv("~/new_bats/Rnew_bats/Bats_data_products/sampling.cov2.csv")
sampling.cov2<- sampling.cov2[,-1]
sampling.cov2<- data.frame(sampling.cov2)
preprocov <-preProcess(sampling.cov2[,1:8], method = c("center","scale"))
sampling.cov2<-predict(preprocov, sampling.cov2[,1:8])
Dailycov3 <- read.csv("~/new_bats/Rnew_bats/Bats_data_products/Dailycov3.csv")
Dailycov3 <- Dailycov3 [,-1]
preproDaily <-preProcess(Dailycov3[,], method = c("knnImpute"))
Dailycov3<-predict(preproDaily, Dailycov3)
Julian<-Dailycov3[,1:3]
Max.hum<-Dailycov3[,4:6]
Max.temp<-Dailycov3[,7:9]
Mean.hum<-Dailycov3[,10:12]
Mean.temp<-Dailycov3[,13:15]
Min.hum<-Dailycov3[,16:18]
Min.temp<-Dailycov3[,19:21]
Sd.hum<-Dailycov3[,22:24]
Sd.temp<-Dailycov3[,25:27]
Dailycov3<- list(Julian,Max.hum, Max.temp, Mean.hum,Mean.temp, Min.hum, Min.temp, Sd.hum, Sd.temp)
names(Dailycov3) <- c("Julian", "Maxhum","Maxtemp","Meanhum", "Meantemp","Minhum","Mintemp","sdhum","sdtemp")
#then add the data
RESULTS <- read.csv("~/new_bats/Rnew_bats/Bats_data_products/RESULTS.csv")
RESULTS <- RESULTS[,-1]
RESULTS$START.DATE<- dmy(as.character(RESULTS$START.DATE), tz = "America/Los_Angeles")
RESULTS$END.DATE<- dmy(as.character(RESULTS$END.DATE), tz = "America/Los_Angeles")
BatOccu <- read.csv("~/new_bats/Rnew_bats/BatOccu.csv")
#print(BatOccu)
BatOccu<-BatOccu[,c(2:16,20:22)]
kable(BatOccu)
View(BatOccu)
spp<-6
spp
ncol(BatOccu)/spp
ncol(BatOccu)
spp
secuencia <- c(1:spp)
secuencia
secuencia <- c(1:ncol(BatOccu)/spp)
secuencia
secuencia <- c(1:(ncol(BatOccu)/spp))
secuencia
secuencia+ secuencia
secuencia2<- c(1:spp)
secuencia
secuencia2
secuencia*seceuncia2
secuencia*secuencia2
secuencia <- c(1:spp)
secuencia <- c(1:spp)*3
secuencia
secuencia <- c(1:spp)*(ncol(BatOccu)/spp)
secuencia
ncol(BatOccu)
spp<-3
ncol(BatOccu)/spp
secuencia <- c(1:spp)*(ncol(BatOccu)/spp)
ncol(BatOccu)
spp<-3
ncol(BatOccu)/spp
secuencia <- c(1:spp)*(ncol(BatOccu)/spp)
secuencia
ncol(BatOccu)
spp<-6
ncol(BatOccu)/spp
secuencia <- c(1:spp)*(ncol(BatOccu)/spp)
secuencia
ncol(BatOccu)
spp<-3
ncol(BatOccu)/spp
secuencia <- c(1:spp)*(ncol(BatOccu)/spp)
secuencia
ncol(BatOccu)
spp<-6
ncol(BatOccu)/spp
secuencia <- c(1:spp)*(ncol(BatOccu)/spp)
secuencia
ncol(BatOccu)
spp<-6
ncol(BatOccu)/spp
secuencia <- c(1:spp)*(ncol(BatOccu)/spp)
secuencia2<-secuencia-(secuencia[1]-1)
secuencia
secuencia2
ncol(BatOccu)
spp<-3
ncol(BatOccu)/spp
secuencia <- c(1:spp)*(ncol(BatOccu)/spp)
secuencia2<-secuencia-(secuencia[1]-1)
secuencia
secuencia2
length(secuencia)
secuencia
ncol(BatOccu)
spp<-6
ncol(BatOccu)/spp
secuencia <- c(1:spp)*(ncol(BatOccu)/spp)
secuencia2<-secuencia-(secuencia[1]-1)
secuencia
secuencia2
result_list <- list()
for(i in 1:length(secuencia))
{
result_list[[i]] <-c(secuencia[i]:secuencia2[i])
}
result_list
ncol(BatOccu)
spp<-6
ncol(BatOccu)/spp
secuencia <- c(1:spp)*(ncol(BatOccu)/spp)
secuencia2<-secuencia-(secuencia[1]-1)
secuencia
secuencia2
result_list <- list()
for(i in 1:length(secuencia))
{
result_list[[i]] <-c(secuencia2[i]:secuencia[i])
}
result_list
result_list[[1]]
result_list[[2]]
result_list[[3]]
result_list[[4]]
result_list[[6]]
ncol(BatOccu)
ncol(BatOccu)
spp<-6
ncol(BatOccu)/spp
secuencia <- c(1:spp)*(ncol(BatOccu)/spp)
secuencia2<-secuencia-(secuencia[1]-1)
secuencia
secuencia2
result_list <- list()
result_DF <- list()
for(i in 1:length(secuencia))
{
result_list[[i]] <-c(secuencia2[i]:secuencia[i])
result_DF[[i]] <- BatOccu[,result_list[[1]]]
}
result_list
result_DF
for(i in 1:length(secuencia))
{
result_list[[i]] <-c(secuencia2[i]:secuencia[i])
result_DF[[i]] <- BatOccu[,result_list[[i]]]
}
result_list
result_DF
length(result_DF)
length(BatOccu)
sampling.cov2
summary(sampling.cov2)
Dailycov3 <- read.csv("~/new_bats/Rnew_bats/Bats_data_products/Dailycov3.csv")
Dailycov3 <- Dailycov3 [,-1]
preproDaily <-preProcess(Dailycov3[,], method = c("knnImpute"))
Dailycov3<-predict(preproDaily, Dailycov3)
Julian<-Dailycov3[,1:3]
Max.hum<-Dailycov3[,4:6]
Max.temp<-Dailycov3[,7:9]
Mean.hum<-Dailycov3[,10:12]
Mean.temp<-Dailycov3[,13:15]
Min.hum<-Dailycov3[,16:18]
Min.temp<-Dailycov3[,19:21]
Sd.hum<-Dailycov3[,22:24]
Sd.temp<-Dailycov3[,25:27]
Dailycov3<- list(Julian,Max.hum, Max.temp, Mean.hum,Mean.temp, Min.hum, Min.temp, Sd.hum, Sd.temp)
names(Dailycov3) <- c("Julian", "Maxhum","Maxtemp","Meanhum", "Meantemp","Minhum","Mintemp","sdhum","sdtemp")
library("caret", lib.loc="~/R/win-library/3.2")
Dailycov3 <- read.csv("~/new_bats/Rnew_bats/Bats_data_products/Dailycov3.csv")
Dailycov3 <- Dailycov3 [,-1]
preproDaily <-preProcess(Dailycov3[,], method = c("knnImpute"))
Dailycov3<-predict(preproDaily, Dailycov3)
Julian<-Dailycov3[,1:3]
Max.hum<-Dailycov3[,4:6]
Max.temp<-Dailycov3[,7:9]
Mean.hum<-Dailycov3[,10:12]
Mean.temp<-Dailycov3[,13:15]
Min.hum<-Dailycov3[,16:18]
Min.temp<-Dailycov3[,19:21]
Sd.hum<-Dailycov3[,22:24]
Sd.temp<-Dailycov3[,25:27]
Dailycov3<- list(Julian,Max.hum, Max.temp, Mean.hum,Mean.temp, Min.hum, Min.temp, Sd.hum, Sd.temp)
names(Dailycov3) <- c("Julian", "Maxhum","Maxtemp","Meanhum", "Meantemp","Minhum","Mintemp","sdhum","sdtemp")
summary(Dailycov3)
length(Dailycov3)
length(sampling.cov2)
form <- ~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~  Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy + I(Burn.intensity.Canopy^2) + Burn.intensity.basal + I(Burn.intensity.basal^2)
form
result_list <- list()
result_DF <- list()
for(i in 1:length(secuencia))
{
result_list[[i]] <-c(secuencia2[i]:secuencia[i])
result_list[[i]] <- BatOccu[,result_list[[i]]]
}
result_list
library(raster)
library(maps)
library(maptools)
library(rgdal)
library(dplyr)
library(knitr)
library(unmarked)
library(lubridate)
library(MuMIn)
library(ggplot2)
library(RCurl)
library(foreign)
library(caret)
library(dismo)
library(vegan)
result_list <- list()
for(i in 1:length(secuencia))
{
result_list[[i]] <-c(secuencia2[i]:secuencia[i])
result_list[[i]] <- BatOccu[,result_list[[i]]]
result_list[[i]] <- unmarkedFrameOccu(y = result_list[[i]], siteCovs =sampling.cov2, obsCovs=Dailycov3)
}
result_list
result_list[[1]]
class(result_list[[1]])
ncol(BatOccu)
spp<-6
form <- ~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~  Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy + I(Burn.intensity.Canopy^2) + Burn.intensity.basal + I(Burn.intensity.basal^2)
ncol(BatOccu)/spp
secuencia <- c(1:spp)*(ncol(BatOccu)/spp)
secuencia2<-secuencia-(secuencia[1]-1)
result_list <- list()
for(i in 1:length(secuencia))
{
result_list[[i]] <-c(secuencia2[i]:secuencia[i])
result_list[[i]] <- BatOccu[,result_list[[i]]]
result_list[[i]] <- unmarkedFrameOccu(y = result_list[[i]], siteCovs =sampling.cov2, obsCovs=Dailycov3)
result_list[[i]] <- occuRN(form, result_list[[i]])
}
result_list
ncol(BatOccu)
spp<-6
form <- ~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~  Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy + I(Burn.intensity.Canopy^2) + Burn.intensity.basal + I(Burn.intensity.basal^2)
ncol(BatOccu)/spp
secuencia <- c(1:spp)*(ncol(BatOccu)/spp)
secuencia2<-secuencia-(secuencia[1]-1)
models <- list()
for(i in 1:length(secuencia))
{
models[[i]] <-c(secuencia2[i]:secuencia[i])
models[[i]] <- BatOccu[,models[[i]]]
models[[i]] <- unmarkedFrameOccu(y = models[[i]], siteCovs =sampling.cov2, obsCovs=Dailycov3)
models[[i]] <- occuRN(form, models[[i]])
}
models
ncol(BatOccu)
spp<-6
form <- ~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~  Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy + I(Burn.intensity.Canopy^2) + Burn.intensity.basal + I(Burn.intensity.basal^2)
ncol(BatOccu)/spp
secuencia <- c(1:spp)*(ncol(BatOccu)/spp)
secuencia2<-secuencia-(secuencia[1]-1)
models <- list()
div <- matrix()
for(i in 1:length(secuencia))
{
models[[i]] <-c(secuencia2[i]:secuencia[i])
models[[i]] <- BatOccu[,models[[i]]]
models[[i]] <- unmarkedFrameOccu(y = models[[i]], siteCovs =sampling.cov2, obsCovs=Dailycov3)
models[[i]] <- occuRN(form, models[[i]])
}
models
?unlist
ncol(BatOccu)
spp<-6
form <- ~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~  Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy + I(Burn.intensity.Canopy^2) + Burn.intensity.basal + I(Burn.intensity.basal^2)
ncol(BatOccu)/spp
secuencia <- c(1:spp)*(ncol(BatOccu)/spp)
secuencia2<-secuencia-(secuencia[1]-1)
models <- list()
div <- list()
for(i in 1:length(secuencia))
{
models[[i]] <-c(secuencia2[i]:secuencia[i])
models[[i]] <- BatOccu[,models[[i]]]
models[[i]] <- unmarkedFrameOccu(y = models[[i]], siteCovs =sampling.cov2, obsCovs=Dailycov3)
models[[i]] <- occuRN(form, models[[i]])
div[[i]] <- predict(models[[i]], type = "state", newdata=sampling.cov2)$Predicted
div1<- as.data.frame(div)
}
models
div
div1
div
View(div1)
dim(div1)
dim(div)
ncol(BatOccu)
spp<-6
form <- ~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~  Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy + I(Burn.intensity.Canopy^2) + Burn.intensity.basal + I(Burn.intensity.basal^2)
ncol(BatOccu)/spp
secuencia <- c(1:spp)*(ncol(BatOccu)/spp)
secuencia2<-secuencia-(secuencia[1]-1)
models <- list()
div <- list()
for(i in 1:length(secuencia))
{
models[[i]] <-c(secuencia2[i]:secuencia[i])
models[[i]] <- BatOccu[,models[[i]]]
models[[i]] <- unmarkedFrameOccu(y = models[[i]], siteCovs =sampling.cov2, obsCovs=Dailycov3)
models[[i]] <- occuRN(form, models[[i]])
div[[i]] <- predict(models[[i]], type = "state", newdata=sampling.cov2)$Predicted
div<- as.data.frame(div)
}
dim(div)
ncol(BatOccu)
spp<-6
form <- ~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~  Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy + I(Burn.intensity.Canopy^2) + Burn.intensity.basal + I(Burn.intensity.basal^2)
ncol(BatOccu)/spp
secuencia <- c(1:spp)*(ncol(BatOccu)/spp)
secuencia2<-secuencia-(secuencia[1]-1)
models <- list()
for(i in 1:length(secuencia))
{
models[[i]] <-c(secuencia2[i]:secuencia[i])
models[[i]] <- BatOccu[,models[[i]]]
models[[i]] <- unmarkedFrameOccu(y = models[[i]], siteCovs =sampling.cov2, obsCovs=Dailycov3)
models[[i]] <- occuRN(form, models[[i]])
div[[i]] <- predict(models[[i]], type = "state", newdata=sampling.cov2)$Predicted
div<- as.data.frame(div)
}
dim(div)
ncol(BatOccu)
spp<-6
form <- ~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~  Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy + I(Burn.intensity.Canopy^2) + Burn.intensity.basal + I(Burn.intensity.basal^2)
ncol(BatOccu)/spp
secuencia <- c(1:spp)*(ncol(BatOccu)/spp)
secuencia2<-secuencia-(secuencia[1]-1)
for(i in 1:length(secuencia))
{
models[[i]] <-c(secuencia2[i]:secuencia[i])
models[[i]] <- BatOccu[,models[[i]]]
models[[i]] <- unmarkedFrameOccu(y = models[[i]], siteCovs =sampling.cov2, obsCovs=Dailycov3)
models[[i]] <- occuRN(form, models[[i]])
div[[i]] <- predict(models[[i]], type = "state", newdata=sampling.cov2)$Predicted
div<- as.data.frame(div)
}
dim(div)
ncol(BatOccu)/spp
rm(div)
rm(div)
rm(div1)
spp<-6
form <- ~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~  Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy + I(Burn.intensity.Canopy^2) + Burn.intensity.basal + I(Burn.intensity.basal^2)
secuencia <- c(1:spp)*(ncol(BatOccu)/spp)
secuencia2<-secuencia-(secuencia[1]-1)
for(i in 1:length(secuencia))
{
models[[i]] <-c(secuencia2[i]:secuencia[i])
models[[i]] <- BatOccu[,models[[i]]]
models[[i]] <- unmarkedFrameOccu(y = models[[i]], siteCovs =sampling.cov2, obsCovs=Dailycov3)
models[[i]] <- occuRN(form, models[[i]])
div[[i]] <- predict(models[[i]], type = "state", newdata=sampling.cov2)$Predicted
div<- as.data.frame(div)
h<-diversity(div)
}
dim(div)
h
spp<-6
form <- ~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~  Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy + I(Burn.intensity.Canopy^2) + Burn.intensity.basal + I(Burn.intensity.basal^2)
secuencia <- c(1:spp)*(ncol(BatOccu)/spp)
secuencia2<-secuencia-(secuencia[1]-1)
for(i in 1:length(secuencia))
models<-list()
div<-list()
{
models[[i]] <-c(secuencia2[i]:secuencia[i])
models[[i]] <- BatOccu[,models[[i]]]
models[[i]] <- unmarkedFrameOccu(y = models[[i]], siteCovs =sampling.cov2, obsCovs=Dailycov3)
models[[i]] <- occuRN(form, models[[i]])
div[[i]] <- predict(models[[i]], type = "state", newdata=sampling.cov2)$Predicted
div<- as.data.frame(div)
h<-diversity(div)
}
models <- list()
div <- list()
for(i in 1:length(secuencia))
{
models[[i]] <-c(secuencia2[i]:secuencia[i])
models[[i]] <- BatOccu[,models[[i]]]
models[[i]] <- unmarkedFrameOccu(y = models[[i]], siteCovs =sampling.cov2, obsCovs=Dailycov3)
models[[i]] <- occuRN(form, models[[i]])
div[[i]] <- predict(models[[i]], type = "state", newdata=sampling.cov2)$Predicted
div<- as.data.frame(div)
}
dim(div)
for(i in 1:length(secuencia))
{
models[[i]] <-c(secuencia2[i]:secuencia[i])
models[[i]] <- BatOccu[,models[[i]]]
models[[i]] <- unmarkedFrameOccu(y = models[[i]], siteCovs =sampling.cov2, obsCovs=Dailycov3)
models[[i]] <- occuRN(form, models[[i]])
div[[i]] <- predict(models[[i]], type = "state", newdata=sampling.cov2)$Predicted
div<- as.data.frame(div)
h<- diversity(div)
}
dim(div)
h
plot(h)
ncol(BatOccu)
spp<-6
form <- ~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~  Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy + I(Burn.intensity.Canopy^2) + Burn.intensity.basal + I(Burn.intensity.basal^2)
ncol(BatOccu)/spp
secuencia <- c(1:spp)*(ncol(BatOccu)/spp)
secuencia2<-secuencia-(secuencia[1]-1)
models <- list()
div <- list()
for(i in 1:length(secuencia))
{
models[[i]] <-c(secuencia2[i]:secuencia[i])
models[[i]] <- BatOccu[,models[[i]]]
models[[i]] <- unmarkedFrameOccu(y = models[[i]], siteCovs =sampling.cov2, obsCovs=Dailycov3)
models[[i]] <- occuRN(form, models[[i]])
div[[i]] <- predict(models[[i]], type = "state", newdata=sampling.cov2)$Predicted
div<- as.data.frame(div)
h<- diversity(div)
}
result <- list(models=models,divers=h)
result
diverityoccu<- function(pres, sitecov, obscov, spp, form) {
secuencia <- c(1:spp)*(ncol(pres)/spp)
secuencia2<-secuencia-(secuencia[1]-1)
models <- list()
div <- list()
for(i in 1:length(secuencia))
{
models[[i]] <-c(secuencia2[i]:secuencia[i])
models[[i]] <- pres[,models[[i]]]
models[[i]] <- unmarkedFrameOccu(y = models[[i]], siteCovs =sitecov, obsCovs=obscov)
models[[i]] <- occuRN(form, models[[i]])
div[[i]] <- predict(models[[i]], type = "state", newdata=sitecov)$Predicted
div<- as.data.frame(div)
h<- diversity(div)
}
result <- list(models=models,divers=h)
}
BatOccu
diversityoccu<- function(pres, sitecov, obscov, spp, form) {
secuencia <- c(1:spp)*(ncol(pres)/spp)
secuencia2<-secuencia-(secuencia[1]-1)
models <- list()
div <- list()
for(i in 1:length(secuencia))
{
models[[i]] <-c(secuencia2[i]:secuencia[i])
models[[i]] <- pres[,models[[i]]]
models[[i]] <- unmarkedFrameOccu(y = models[[i]], siteCovs =sitecov, obsCovs=obscov)
models[[i]] <- occuRN(form, models[[i]])
div[[i]] <- predict(models[[i]], type = "state", newdata=sitecov)$Predicted
div<- as.data.frame(div)
h<- diversity(div)
}
result <- list(models=models,divers=h)
}
diversityoccu(pres = BatOccu, sitecov = sampling.cov2, obscov = Dailycov3, form = ~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~  Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy + I(Burn.intensity.Canopy^2) + Burn.intensity.basal + I(Burn.intensity.basal^2))
diversityoccu(pres = BatOccu, sitecov = sampling.cov2, obscov = Dailycov3, form = ~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~  Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy + I(Burn.intensity.Canopy^2) + Burn.intensity.basal + I(Burn.intensity.basal^2), spp = 6)
result
rm(result)
rm(RESULTS)
diversityoccu(pres = BatOccu, sitecov = sampling.cov2, obscov = Dailycov3, form = ~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~  Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy + I(Burn.intensity.Canopy^2) + Burn.intensity.basal + I(Burn.intensity.basal^2), spp = 6)
diversityoccu<- function(pres, sitecov, obscov, spp, form) {
secuencia <- c(1:spp)*(ncol(pres)/spp)
secuencia2<-secuencia-(secuencia[1]-1)
models <- list()
div <- list()
for(i in 1:length(secuencia))
{
models[[i]] <-c(secuencia2[i]:secuencia[i])
models[[i]] <- pres[,models[[i]]]
models[[i]] <- unmarkedFrameOccu(y = models[[i]], siteCovs =sitecov, obsCovs=obscov)
models[[i]] <- occuRN(form, models[[i]])
div[[i]] <- predict(models[[i]], type = "state", newdata=sitecov)$Predicted
div<- as.data.frame(div)
h<- diversity(div)
}
result <- list(models=models,divers=h)
return(result)
}
diversityoccu(pres = BatOccu, sitecov = sampling.cov2, obscov = Dailycov3, form = ~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~  Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy + I(Burn.intensity.Canopy^2) + Burn.intensity.basal + I(Burn.intensity.basal^2), spp = 6)
diversityoccu(pres = BatOccu, sitecov = sampling.cov2, obscov = Dailycov3, form = ~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~  Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy + I(Burn.intensity.Canopy^2) + Burn.intensity.basal + I(Burn.intensity.basal^2), spp = 6)$divers
diversityoccu<- function(pres, sitecov, obscov, spp, form) {
secuencia <- c(1:spp)*(ncol(pres)/spp)
secuencia2<-secuencia-(secuencia[1]-1)
models <- list()
div <- list()
for(i in 1:length(secuencia))
{
models[[i]] <-c(secuencia2[i]:secuencia[i])
models[[i]] <- pres[,models[[i]]]
models[[i]] <- unmarkedFrameOccu(y = models[[i]], siteCovs =sitecov, obsCovs=obscov)
models[[i]] <- occuRN(form, models[[i]])
div[[i]] <- predict(models[[i]], type = "state", newdata=sitecov)$Predicted
div<- as.data.frame(div)
h<- diversity(div)
}
result <- list(models=models,Diversity=h)
return(result)
}
diversityoccu(pres = BatOccu, sitecov = sampling.cov2, obscov = Dailycov3, form = ~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~  Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy + I(Burn.intensity.Canopy^2) + Burn.intensity.basal + I(Burn.intensity.basal^2), spp = 6)$Diversity
plot(diversityoccu(pres = BatOccu, sitecov = sampling.cov2, obscov = Dailycov3, form = ~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~  Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy + I(Burn.intensity.Canopy^2) + Burn.intensity.basal + I(Burn.intensity.basal^2), spp = 6)$Diversity)
plot(diversityoccu(pres = BatOccu, sitecov = sampling.cov2, obscov = Dailycov3, form = ~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~  Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy + I(Burn.intensity.Canopy^2) + Burn.intensity.basal + I(Burn.intensity.basal^2), spp = 6)$Diversity)
library(unmarked)
plot(diversityoccu(pres = BatOccu, sitecov = sampling.cov2, obscov = Dailycov3, form = ~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~  Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy + I(Burn.intensity.Canopy^2) + Burn.intensity.basal + I(Burn.intensity.basal^2), spp = 6)$Diversity)
library(vegan)
plot(diversityoccu(pres = BatOccu, sitecov = sampling.cov2, obscov = Dailycov3, form = ~ Julian + Meanhum + Meantemp + sdhum + sdtemp ~  Burn.intensity.soil + I(Burn.intensity.soil^2) + Burn.intensity.Canopy + I(Burn.intensity.Canopy^2) + Burn.intensity.basal + I(Burn.intensity.basal^2), spp = 6)$Diversity)
